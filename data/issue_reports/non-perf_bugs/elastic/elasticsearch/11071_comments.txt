[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102411664","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-102411664","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":102411664,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjQxMTY2NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-05-15T14:18:41Z","updated_at":"2015-05-15T14:18:41Z","author_association":"CONTRIBUTOR","body":"@bradvido I've tried various combinations of mappings etc to replicate this problem on 1.5.2, and it all seems to work just fine.  Could you add a small recreation?  \n\nFor some reason Groovy is converting one of those values to BigDecimal (which we don't support), but I can't see why it is doing that.  I found this bug which may be related? http://jira.codehaus.org/browse/GROOVY-7238\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102414068","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-102414068","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":102414068,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjQxNDA2OA==","user":{"login":"bradvido","id":884611,"node_id":"MDQ6VXNlcjg4NDYxMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/884611?v=4","gravatar_id":"","url":"https://api.github.com/users/bradvido","html_url":"https://github.com/bradvido","followers_url":"https://api.github.com/users/bradvido/followers","following_url":"https://api.github.com/users/bradvido/following{/other_user}","gists_url":"https://api.github.com/users/bradvido/gists{/gist_id}","starred_url":"https://api.github.com/users/bradvido/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradvido/subscriptions","organizations_url":"https://api.github.com/users/bradvido/orgs","repos_url":"https://api.github.com/users/bradvido/repos","events_url":"https://api.github.com/users/bradvido/events{/privacy}","received_events_url":"https://api.github.com/users/bradvido/received_events","type":"User","site_admin":false},"created_at":"2015-05-15T14:28:42Z","updated_at":"2015-05-15T14:32:30Z","author_association":"CONTRIBUTOR","body":"I should mention I'm running ES on Windows -- maybe the bug is platform specific,\n\nAlso, in Groovy, [every literal number with a decimal point becomes a BigDecimal](http://docs.codehaus.org/display/GROOVY/Groovy+Math).  It  needs a 'd' identifier to be treated as a double.\n\nSo maybe, i should change the literal `0.0` to `0.0d` in my script?  I'll test when I have time to get back to this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102444693","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-102444693","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":102444693,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjQ0NDY5Mw==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-05-15T15:54:27Z","updated_at":"2015-05-15T15:54:27Z","author_association":"MEMBER","body":"We automatically convert BigDecimal constants to floating-point, see here: https://github.com/elastic/elasticsearch/pull/6609\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102449820","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-102449820","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":102449820,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjQ0OTgyMA==","user":{"login":"bradvido","id":884611,"node_id":"MDQ6VXNlcjg4NDYxMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/884611?v=4","gravatar_id":"","url":"https://api.github.com/users/bradvido","html_url":"https://github.com/bradvido","followers_url":"https://api.github.com/users/bradvido/followers","following_url":"https://api.github.com/users/bradvido/following{/other_user}","gists_url":"https://api.github.com/users/bradvido/gists{/gist_id}","starred_url":"https://api.github.com/users/bradvido/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradvido/subscriptions","organizations_url":"https://api.github.com/users/bradvido/orgs","repos_url":"https://api.github.com/users/bradvido/repos","events_url":"https://api.github.com/users/bradvido/events{/privacy}","received_events_url":"https://api.github.com/users/bradvido/received_events","type":"User","site_admin":false},"created_at":"2015-05-15T16:09:01Z","updated_at":"2015-05-15T16:09:01Z","author_association":"CONTRIBUTOR","body":"Hmm, then it shouldn't make a difference if i use literal decimals in my script.  I'll try to find a simple way so others can reproduce this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/112745962","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-112745962","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":112745962,"node_id":"MDEyOklzc3VlQ29tbWVudDExMjc0NTk2Mg==","user":{"login":"fredrlx","id":11191131,"node_id":"MDQ6VXNlcjExMTkxMTMx","avatar_url":"https://avatars2.githubusercontent.com/u/11191131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredrlx","html_url":"https://github.com/fredrlx","followers_url":"https://api.github.com/users/fredrlx/followers","following_url":"https://api.github.com/users/fredrlx/following{/other_user}","gists_url":"https://api.github.com/users/fredrlx/gists{/gist_id}","starred_url":"https://api.github.com/users/fredrlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredrlx/subscriptions","organizations_url":"https://api.github.com/users/fredrlx/orgs","repos_url":"https://api.github.com/users/fredrlx/repos","events_url":"https://api.github.com/users/fredrlx/events{/privacy}","received_events_url":"https://api.github.com/users/fredrlx/received_events","type":"User","site_admin":false},"created_at":"2015-06-17T10:17:29Z","updated_at":"2015-06-17T10:17:29Z","author_association":"NONE","body":"Hi! I've run into a similar issue (same \"Can't write type [class java.math.BigDecimal]\" exception on some shards). Our groovy script had this line:\n\n```\ns = round(s*100)/100; \n```\n\nrewriting it to the following got rid of the exception:\n\n```\ns = round(s*100d)/100d; \n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/113573850","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-113573850","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":113573850,"node_id":"MDEyOklzc3VlQ29tbWVudDExMzU3Mzg1MA==","user":{"login":"bradvido","id":884611,"node_id":"MDQ6VXNlcjg4NDYxMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/884611?v=4","gravatar_id":"","url":"https://api.github.com/users/bradvido","html_url":"https://github.com/bradvido","followers_url":"https://api.github.com/users/bradvido/followers","following_url":"https://api.github.com/users/bradvido/following{/other_user}","gists_url":"https://api.github.com/users/bradvido/gists{/gist_id}","starred_url":"https://api.github.com/users/bradvido/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradvido/subscriptions","organizations_url":"https://api.github.com/users/bradvido/orgs","repos_url":"https://api.github.com/users/bradvido/repos","events_url":"https://api.github.com/users/bradvido/events{/privacy}","received_events_url":"https://api.github.com/users/bradvido/received_events","type":"User","site_admin":false},"created_at":"2015-06-19T16:54:37Z","updated_at":"2015-06-19T16:54:37Z","author_association":"CONTRIBUTOR","body":"@fredrlx what version of ES & Groovy are you using?  #6609 should have already take care of this, but I've seen similar results.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/114039962","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-114039962","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":114039962,"node_id":"MDEyOklzc3VlQ29tbWVudDExNDAzOTk2Mg==","user":{"login":"fredrlx","id":11191131,"node_id":"MDQ6VXNlcjExMTkxMTMx","avatar_url":"https://avatars2.githubusercontent.com/u/11191131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredrlx","html_url":"https://github.com/fredrlx","followers_url":"https://api.github.com/users/fredrlx/followers","following_url":"https://api.github.com/users/fredrlx/following{/other_user}","gists_url":"https://api.github.com/users/fredrlx/gists{/gist_id}","starred_url":"https://api.github.com/users/fredrlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredrlx/subscriptions","organizations_url":"https://api.github.com/users/fredrlx/orgs","repos_url":"https://api.github.com/users/fredrlx/repos","events_url":"https://api.github.com/users/fredrlx/events{/privacy}","received_events_url":"https://api.github.com/users/fredrlx/received_events","type":"User","site_admin":false},"created_at":"2015-06-22T08:40:29Z","updated_at":"2015-06-22T08:40:29Z","author_association":"NONE","body":"@bradvido We were using ES 1.5.1 when we had this issue. How do I check what version of Groovy I have ? I'll update ES to a more recent version, but the issue was solved with the \"d\" postfix on constants.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122012407","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-122012407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":122012407,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjAxMjQwNw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-07-16T16:31:21Z","updated_at":"2015-07-16T16:31:21Z","author_association":"CONTRIBUTOR","body":"This should be fixed by #12288 - I'm going to close for now, but feel free to reopen if you see the same thing on 1.7.0 or later\n\nthaks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122013036","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-122013036","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":122013036,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjAxMzAzNg==","user":{"login":"bradvido","id":884611,"node_id":"MDQ6VXNlcjg4NDYxMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/884611?v=4","gravatar_id":"","url":"https://api.github.com/users/bradvido","html_url":"https://github.com/bradvido","followers_url":"https://api.github.com/users/bradvido/followers","following_url":"https://api.github.com/users/bradvido/following{/other_user}","gists_url":"https://api.github.com/users/bradvido/gists{/gist_id}","starred_url":"https://api.github.com/users/bradvido/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradvido/subscriptions","organizations_url":"https://api.github.com/users/bradvido/orgs","repos_url":"https://api.github.com/users/bradvido/repos","events_url":"https://api.github.com/users/bradvido/events{/privacy}","received_events_url":"https://api.github.com/users/bradvido/received_events","type":"User","site_admin":false},"created_at":"2015-07-16T16:33:44Z","updated_at":"2015-07-16T16:33:44Z","author_association":"CONTRIBUTOR","body":"Thanks. Will test on 1.7.0\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/242135821","html_url":"https://github.com/elastic/elasticsearch/issues/11071#issuecomment-242135821","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11071","id":242135821,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MjEzNTgyMQ==","user":{"login":"mausch","id":95194,"node_id":"MDQ6VXNlcjk1MTk0","avatar_url":"https://avatars1.githubusercontent.com/u/95194?v=4","gravatar_id":"","url":"https://api.github.com/users/mausch","html_url":"https://github.com/mausch","followers_url":"https://api.github.com/users/mausch/followers","following_url":"https://api.github.com/users/mausch/following{/other_user}","gists_url":"https://api.github.com/users/mausch/gists{/gist_id}","starred_url":"https://api.github.com/users/mausch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mausch/subscriptions","organizations_url":"https://api.github.com/users/mausch/orgs","repos_url":"https://api.github.com/users/mausch/repos","events_url":"https://api.github.com/users/mausch/events{/privacy}","received_events_url":"https://api.github.com/users/mausch/received_events","type":"User","site_admin":false},"created_at":"2016-08-24T16:57:02Z","updated_at":"2016-08-24T16:57:02Z","author_association":"NONE","body":"Just hit this issue in 1.7.2. I know this is an old issue and an old version of ES, just wanted to say for future reference that changing an expression from `xxx.sum(0)` to `xxx.sum(0d)` as suggested above did the trick.\nAlso, this only happened in a `script_fields` script. The same script did not crash as a `function_score`.\n","performed_via_github_app":null}]
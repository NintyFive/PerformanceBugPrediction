{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11513","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11513/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11513/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11513/events","html_url":"https://github.com/elastic/elasticsearch/issues/11513","id":85519992,"node_id":"MDU6SXNzdWU4NTUxOTk5Mg==","number":11513,"title":"for fields with numeric type 'byte', elasticsearch accepts values greater than 127 and indexes them wrongly","user":{"login":"passing","id":8142186,"node_id":"MDQ6VXNlcjgxNDIxODY=","avatar_url":"https://avatars0.githubusercontent.com/u/8142186?v=4","gravatar_id":"","url":"https://api.github.com/users/passing","html_url":"https://github.com/passing","followers_url":"https://api.github.com/users/passing/followers","following_url":"https://api.github.com/users/passing/following{/other_user}","gists_url":"https://api.github.com/users/passing/gists{/gist_id}","starred_url":"https://api.github.com/users/passing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/passing/subscriptions","organizations_url":"https://api.github.com/users/passing/orgs","repos_url":"https://api.github.com/users/passing/repos","events_url":"https://api.github.com/users/passing/events{/privacy}","received_events_url":"https://api.github.com/users/passing/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2015-06-05T12:24:21Z","updated_at":"2016-04-14T15:57:09Z","closed_at":"2016-04-14T15:57:09Z","author_association":"NONE","active_lock_reason":null,"body":"using elasticsearch 1.5.2 I can index values greater than 127 for a byte field without getting any error. The values just overflow internally and the resulting numbers can be searched for.\ne.g. indexing 250 ends up as -6\nindexing 260 ends up as 4\n\n```\ncurl -XPUT localhost:9200/test -d '\n{\n    \"mappings\" : {\n        \"foo\" : {\n            \"properties\" : {\n                \"field1\" : { \"type\" : \"byte\" }\n            }\n        }\n    }\n}'\n\ncurl -XPUT localhost:9200/test/foo/one -d '\n{\n  \"field1\" : 127\n}'\n\ncurl -XPUT localhost:9200/test/foo/two -d '\n{\n  \"field1\" : 250\n}'\n\ncurl -XPUT localhost:9200/test/foo/three -d '\n{\n  \"field1\" : 260\n}'\n```\n\nnow searching like this...\n\n```\ncurl -XGET localhost:9200/test/_search?search_type=count -d '\n{\n    \"aggs\" : {\n        \"values\" : {\n            \"terms\" : { \"field\" : \"field1\" }\n        }\n    }\n}'\n```\n\nreturns the following resultset\n\n```\n{\n   \"took\": 3,\n   \"timed_out\": false,\n   \"_shards\": {\n      \"total\": 5,\n      \"successful\": 5,\n      \"failed\": 0\n   },\n   \"hits\": {\n      \"total\": 3,\n      \"max_score\": 0,\n      \"hits\": []\n   },\n   \"aggregations\": {\n      \"values\": {\n         \"doc_count_error_upper_bound\": 0,\n         \"sum_other_doc_count\": 0,\n         \"buckets\": [\n            {\n               \"key\": -6,\n               \"doc_count\": 1\n            },\n            {\n               \"key\": 4,\n               \"doc_count\": 1\n            },\n            {\n               \"key\": 127,\n               \"doc_count\": 1\n            }\n         ]\n      }\n   }\n}\n```\n\ntrying the same with a 'short' number, you get an error message for document 'two'\n\n```\ncurl -XPUT localhost:9200/test -d '\n{\n    \"mappings\" : {\n        \"foo\" : {\n            \"properties\" : {\n                \"field1\" : { \"type\" : \"short\" }\n            }\n        }\n    }\n}'\n\n\ncurl -XPUT localhost:9200/test/foo/one -d '\n{\n  \"field1\" : 31000\n}'\n\ncurl -XPUT localhost:9200/test/foo/two -d '\n{\n  \"field1\" : 33000\n}'\n```\n\n```\n{\n   \"error\": \"RemoteTransportException[[dev-test-mon-es-02][inet[/192.168.110.83:9300]][indices:data/write/index]]; nested: MapperParsingException[failed to parse [field1]]; nested: JsonParseException[Numeric value (33000) out of range of Java short\\n at [Source: UNKNOWN; line: 2, column: 19]]; \",\n   \"status\": 400\n}\n```\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
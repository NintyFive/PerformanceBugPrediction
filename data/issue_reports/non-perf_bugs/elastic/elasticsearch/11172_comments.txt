[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172627829","html_url":"https://github.com/elastic/elasticsearch/issues/11172#issuecomment-172627829","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11172","id":172627829,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjYyNzgyOQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-18T19:22:35Z","updated_at":"2016-01-18T19:22:35Z","author_association":"CONTRIBUTOR","body":"also the new reindex API\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373677276","html_url":"https://github.com/elastic/elasticsearch/issues/11172#issuecomment-373677276","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11172","id":373677276,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzY3NzI3Ng==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-03-16T10:50:04Z","updated_at":"2018-03-16T10:50:04Z","author_association":"MEMBER","body":"@elastic/es-search-aggs ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/495182967","html_url":"https://github.com/elastic/elasticsearch/issues/11172#issuecomment-495182967","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11172","id":495182967,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTE4Mjk2Nw==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2019-05-23T11:41:20Z","updated_at":"2019-05-23T11:41:20Z","author_association":"CONTRIBUTOR","body":"The issue is still relevant, and we can improve the validation of the following APIs based how complete is source: \r\n- update\r\n- update_by_query\r\n- reindex \r\n\r\nFor example, currently `reindex` API  only check if the source is available. We can add extra checks if the some fields are missing (`isComplete() == true`) or if reindex API is using only some fields for reindexing, we can add a check to make sure these fields are preset in the _source. If not, we can throw an error and don't proceed with reindexing. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/495183580","html_url":"https://github.com/elastic/elasticsearch/issues/11172#issuecomment-495183580","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11172","id":495183580,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTE4MzU4MA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-05-23T11:43:28Z","updated_at":"2019-05-23T11:43:28Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/509176677","html_url":"https://github.com/elastic/elasticsearch/issues/11172#issuecomment-509176677","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11172","id":509176677,"node_id":"MDEyOklzc3VlQ29tbWVudDUwOTE3NjY3Nw==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-07-08T10:47:30Z","updated_at":"2019-07-12T12:01:20Z","author_association":"CONTRIBUTOR","body":"It seems likely that in all 3 cases, some kind of opt-in would be necessary if we change the default to fail on excluded fields. It can be argued that going into a filtered source use case is advanced and with the current functionality you get what you asked for.\r\n\r\nReindex takes `_source` as is, runs it through an optional script and then indexes into destination. Failing if some fields are excluded from `_source`, would lead to an opt-in option to allow this for the cases where the excluded fields are not needed in target. The question is if this extra option is worth the confusion that such an option could cause for all the full `_source` cases/users.\r\n\r\nReindex supports source filtering. We could in principle fail if source filtering specifies an excluded field. However, source filtering supports wild cards and I think we would have to choose one of:\r\n\r\n* Leave is, no failure\r\n* Fail if any source filter expands to an excluded field\r\n* Fail only if source filter does not expand to an included field\r\n* Add an opt-in option.\r\n\r\nUpdate could be a different matter, I originally imagined the script being able extract the excluded fields from doc-values. But that seems like it is currently not supported. Nevertheless, for expert usage just failing without an override option could rule out valid use cases?\r\n\r\nNotice that all 3 APIs already fail if `_source` is disabled.\r\n\r\nLabelled this discuss to discuss above.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/510882640","html_url":"https://github.com/elastic/elasticsearch/issues/11172#issuecomment-510882640","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11172","id":510882640,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMDg4MjY0MA==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-07-12T13:17:20Z","updated_at":"2019-07-12T13:17:20Z","author_association":"CONTRIBUTOR","body":"We discussed this in FixitFriday and agreed not to fix this in order not to have to add an opt-in option for the probable cases where the current functionality (loosing the excluded fields during reindex and update) is what is wanted.","performed_via_github_app":null}]
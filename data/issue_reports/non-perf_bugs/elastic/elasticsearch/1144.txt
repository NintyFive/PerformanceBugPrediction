{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1144","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1144/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1144/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1144/events","html_url":"https://github.com/elastic/elasticsearch/issues/1144","id":1264732,"node_id":"MDU6SXNzdWUxMjY0NzMy","number":1144,"title":"Mvel: \".lats\" and \".lons\" fails in array of geopoints (.values[x].lat/lon works)","user":{"login":"Alex-Ikanow","id":851950,"node_id":"MDQ6VXNlcjg1MTk1MA==","avatar_url":"https://avatars2.githubusercontent.com/u/851950?v=4","gravatar_id":"","url":"https://api.github.com/users/Alex-Ikanow","html_url":"https://github.com/Alex-Ikanow","followers_url":"https://api.github.com/users/Alex-Ikanow/followers","following_url":"https://api.github.com/users/Alex-Ikanow/following{/other_user}","gists_url":"https://api.github.com/users/Alex-Ikanow/gists{/gist_id}","starred_url":"https://api.github.com/users/Alex-Ikanow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Alex-Ikanow/subscriptions","organizations_url":"https://api.github.com/users/Alex-Ikanow/orgs","repos_url":"https://api.github.com/users/Alex-Ikanow/repos","events_url":"https://api.github.com/users/Alex-Ikanow/events{/privacy}","received_events_url":"https://api.github.com/users/Alex-Ikanow/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2011-07-21T17:49:31Z","updated_at":"2011-08-10T17:12:53Z","closed_at":"2011-08-10T17:12:53Z","author_association":"NONE","active_lock_reason":null,"body":"From http://groups.google.com/a/elasticsearch.com/group/users/browse_thread/thread/95d0a4a9a11a3730/c66c31c72280be7d#c66c31c72280be7d:\n\nI have a set of documents with an array of geo-points (the mapping is enforced, and the dataset happens to guarantee all documents have 2+ values in the array ... see also the next issue I'm about to create!). \n\nI am trying to run some mvel scripts that generate various fields based on the lat/long values in the array. \n\n1] This test case works, I do \n\n\"i = 0; d = 0; if (doc['locs'].values.length > 0) { d = doc['locs'].lons[0]; } d;\" \n\nhttps://gist.github.com/1092577 \n\n2] This trivial change causes it to fail: \n\n\"i = 0; d = 0; if (doc['locs'].values.length > 0) { d = doc['locs'].lons[i]; } d;\" \n\nhttps://gist.github.com/1092581 \n\n(ie I change the index of the lons array to be \"i\" vs 0; It also fails  with i declared as int, long, Integer, or Long; or the array index  being (int)0, (Integer)0, (long)0, (Long)0) \n\n3] The following was a workaround:   \n\n\"i = 0; d = 0; if (doc['locs'].values.length > 0) { d = doc['locs'].values[i].lat; } d;\" \n\nie it looks like there's a bug with the \".lats\" and \".lons\" shortcuts.\n","closed_by":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
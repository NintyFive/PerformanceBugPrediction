{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11645","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11645/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11645/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11645/events","html_url":"https://github.com/elastic/elasticsearch/issues/11645","id":87923472,"node_id":"MDU6SXNzdWU4NzkyMzQ3Mg==","number":11645,"title":"Per Shard Optimize API","user":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"labels":[{"id":163824881,"node_id":"MDU6TGFiZWwxNjM4MjQ4ODE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Indices%20APIs","name":":Core/Features/Indices APIs","color":"0e8a16","default":false,"description":"APIs to create and manage indices"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2015-06-13T04:02:23Z","updated_at":"2015-08-26T19:59:05Z","closed_at":"2015-08-26T19:59:05Z","author_association":"MEMBER","active_lock_reason":null,"body":"Currently, the `_optimize` API exists to optimize an entire index by merging segments in the background. In general, it's key to merge all segments to 1 (`max_num_segments=1`). However, if you have a very high workload, then it can be a very slow and expensive operation. Worse, optimizing an index that has replicas requires that both the primary and replica(s) be optimized separately.\n\nIt would be great if we could provide an improved optimize API that allows further control:\n- Optimize specific shards of an index\n  - This would be particularly helpful with routing scenarios where shards could be tuned as-needed without impacting the rest of the shards (note: for time based indices, it's still optimal to optimize all of them, but it may be easier to wait for the remaining shards)\n  - It also has the added benefit that you can better predict its impact, both in terms of file capacity _and_ processing. Since you may have multiple shards per node, it also avoids running them in parallel.\n- Choose to optimize a specific shard (not only the shard, but which node if replica shards exist)\n- Offer the ability to optimize a single shard, then copy the optimized shard rather than duplicating the effort on its primary/replica peer.\n  - This would allow people to choose to spend a little bit of short lived memory and network bandwidth rather than the current overhead associated (processing, longer lived memory, and more IO).\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
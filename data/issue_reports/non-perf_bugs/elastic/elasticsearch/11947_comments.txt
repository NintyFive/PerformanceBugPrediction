[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/117509518","html_url":"https://github.com/elastic/elasticsearch/issues/11947#issuecomment-117509518","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11947","id":117509518,"node_id":"MDEyOklzc3VlQ29tbWVudDExNzUwOTUxOA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-07-01T07:37:57Z","updated_at":"2015-07-01T07:37:57Z","author_association":"CONTRIBUTOR","body":"@areek please could you investigate\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/127430890","html_url":"https://github.com/elastic/elasticsearch/issues/11947#issuecomment-127430890","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11947","id":127430890,"node_id":"MDEyOklzc3VlQ29tbWVudDEyNzQzMDg5MA==","user":{"login":"vreon","id":52548,"node_id":"MDQ6VXNlcjUyNTQ4","avatar_url":"https://avatars0.githubusercontent.com/u/52548?v=4","gravatar_id":"","url":"https://api.github.com/users/vreon","html_url":"https://github.com/vreon","followers_url":"https://api.github.com/users/vreon/followers","following_url":"https://api.github.com/users/vreon/following{/other_user}","gists_url":"https://api.github.com/users/vreon/gists{/gist_id}","starred_url":"https://api.github.com/users/vreon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vreon/subscriptions","organizations_url":"https://api.github.com/users/vreon/orgs","repos_url":"https://api.github.com/users/vreon/repos","events_url":"https://api.github.com/users/vreon/events{/privacy}","received_events_url":"https://api.github.com/users/vreon/received_events","type":"User","site_admin":false},"created_at":"2015-08-03T23:29:32Z","updated_at":"2015-08-03T23:29:32Z","author_association":"NONE","body":"We ran into this issue as well (also 1.6).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/144344842","html_url":"https://github.com/elastic/elasticsearch/issues/11947#issuecomment-144344842","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11947","id":144344842,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NDM0NDg0Mg==","user":{"login":"aparo","id":28075,"node_id":"MDQ6VXNlcjI4MDc1","avatar_url":"https://avatars1.githubusercontent.com/u/28075?v=4","gravatar_id":"","url":"https://api.github.com/users/aparo","html_url":"https://github.com/aparo","followers_url":"https://api.github.com/users/aparo/followers","following_url":"https://api.github.com/users/aparo/following{/other_user}","gists_url":"https://api.github.com/users/aparo/gists{/gist_id}","starred_url":"https://api.github.com/users/aparo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aparo/subscriptions","organizations_url":"https://api.github.com/users/aparo/orgs","repos_url":"https://api.github.com/users/aparo/repos","events_url":"https://api.github.com/users/aparo/events{/privacy}","received_events_url":"https://api.github.com/users/aparo/received_events","type":"User","site_admin":false},"created_at":"2015-09-30T10:02:23Z","updated_at":"2015-09-30T10:02:23Z","author_association":"NONE","body":"I ran in this issue with 2.0-beta2. With a similar configuration of @jhariani.\nThe shards are random failing executing many times the same call.\nThe fails are related to preFilter call in o.e.search.suggest.phrase.DirectCandidateGenerator.preFilter(DirectCandidateGenerator.java:115)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/144349570","html_url":"https://github.com/elastic/elasticsearch/issues/11947#issuecomment-144349570","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11947","id":144349570,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NDM0OTU3MA==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2015-09-30T10:31:51Z","updated_at":"2015-09-30T10:31:51Z","author_association":"CONTRIBUTOR","body":"This was supposed to have been fixed in d97afd52f3e743547277c8fea6fb02fbe2bdc1ff ... and that fix is in 2.0-beta2 ... @aparo can you post more details about the exception?  Was there an initial exception before you hit the `close() call missing`?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/156474439","html_url":"https://github.com/elastic/elasticsearch/issues/11947#issuecomment-156474439","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11947","id":156474439,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NjQ3NDQzOQ==","user":{"login":"jelmerk","id":133639,"node_id":"MDQ6VXNlcjEzMzYzOQ==","avatar_url":"https://avatars2.githubusercontent.com/u/133639?v=4","gravatar_id":"","url":"https://api.github.com/users/jelmerk","html_url":"https://github.com/jelmerk","followers_url":"https://api.github.com/users/jelmerk/followers","following_url":"https://api.github.com/users/jelmerk/following{/other_user}","gists_url":"https://api.github.com/users/jelmerk/gists{/gist_id}","starred_url":"https://api.github.com/users/jelmerk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jelmerk/subscriptions","organizations_url":"https://api.github.com/users/jelmerk/orgs","repos_url":"https://api.github.com/users/jelmerk/repos","events_url":"https://api.github.com/users/jelmerk/events{/privacy}","received_events_url":"https://api.github.com/users/jelmerk/received_events","type":"User","site_admin":false},"created_at":"2015-11-13T16:06:27Z","updated_at":"2015-11-13T16:12:42Z","author_association":"NONE","body":"We are still seeing this issue on elastic 1.7.1 when using the following generator in a phrase suggester\n\n```\n   {\n      \"field\" : \"title.reversed\",\n      \"prefix_length\" : 2,\n      \"pre_filter\" : \"reverser\",\n      \"post_filter\" : \"reverser\"\n    }\n```\n\nWhere reverser looks like this :\n\n```\n    \"reverser\": {\n      \"tokenizer\": \"standard\",\n      \"filter\": [\n        \"lowercase\",\n        \"dutch_stopwords\",\n        \"asciifolding\",\n        \"reverse\"\n      ]\n    }\n```\n\nif I take out the pre_filter things it does not fail\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/157424415","html_url":"https://github.com/elastic/elasticsearch/issues/11947#issuecomment-157424415","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11947","id":157424415,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NzQyNDQxNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-11-17T16:35:56Z","updated_at":"2015-11-17T16:35:56Z","author_association":"CONTRIBUTOR","body":"@jelmerk the fix is in 2.0\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/388008347","html_url":"https://github.com/elastic/elasticsearch/issues/11947#issuecomment-388008347","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11947","id":388008347,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODAwODM0Nw==","user":{"login":"genafox","id":14916451,"node_id":"MDQ6VXNlcjE0OTE2NDUx","avatar_url":"https://avatars3.githubusercontent.com/u/14916451?v=4","gravatar_id":"","url":"https://api.github.com/users/genafox","html_url":"https://github.com/genafox","followers_url":"https://api.github.com/users/genafox/followers","following_url":"https://api.github.com/users/genafox/following{/other_user}","gists_url":"https://api.github.com/users/genafox/gists{/gist_id}","starred_url":"https://api.github.com/users/genafox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/genafox/subscriptions","organizations_url":"https://api.github.com/users/genafox/orgs","repos_url":"https://api.github.com/users/genafox/repos","events_url":"https://api.github.com/users/genafox/events{/privacy}","received_events_url":"https://api.github.com/users/genafox/received_events","type":"User","site_admin":false},"created_at":"2018-05-10T09:52:30Z","updated_at":"2018-05-10T09:52:30Z","author_association":"NONE","body":"Hi,\r\nI`ve got the same error on elasticsearch 6.2.4:\r\n\r\nIndex:\r\n`PUT phrase-suggester-test-index\r\n{\r\n  \"settings\": {\r\n    \"index\": {\r\n      \"number_of_shards\": 1,\r\n      \"analysis\": {\r\n        \"analyzer\": {\r\n          \"trigram\": {\r\n            \"type\": \"custom\",\r\n            \"tokenizer\": \"standard\",\r\n            \"filter\": [\r\n              \"standard\",\r\n              \"shingle\"\r\n            ]\r\n          },\r\n          \"reverse\": {\r\n            \"type\": \"custom\",\r\n            \"tokenizer\": \"standard\",\r\n            \"filter\": [\r\n              \"standard\",\r\n              \"reverse\"\r\n            ]\r\n          },\r\n          \"wordnet-synonym-analyzer\": {\r\n            \"type\": \"custom\",\r\n            \"tokenizer\": \"standard\",\r\n            \"filter\": [\r\n              \"lowercase\",\r\n              \"synonym\"\r\n            ]\r\n          }\r\n        },\r\n        \"filter\": {\r\n          \"shingle\": {\r\n            \"type\": \"shingle\",\r\n            \"min_shingle_size\": 2,\r\n            \"max_shingle_size\": 3\r\n          },\r\n          \"synonym\": {\r\n            \"type\": \"synonym\",\r\n            \"format\": \"wordnet\",\r\n            \"synonyms_path\": \"analysis/wn_s.pl\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"mappings\": {\r\n    \"test\": {\r\n      \"properties\": {\r\n        \"title\": {\r\n          \"type\": \"text\",\r\n          \"fields\": {\r\n            \"trigram\": {\r\n              \"type\": \"text\",\r\n              \"analyzer\": \"trigram\"\r\n            },\r\n            \"reverse\": {\r\n              \"type\": \"text\",\r\n              \"analyzer\": \"reverse\"\r\n            },\r\n            \"synonym\": {\r\n              \"type\": \"text\",\r\n              \"analyzer\": \"wordnet-synonym-analyzer\"\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}`\r\n\r\nData:\r\n`POST phrase-suggester-test-index/test?refresh=true\r\n{\"title\": \"Captain America\"}\r\n`\r\n\r\nRequest:\r\n`POST phrase-suggester-test-index/_search\r\n{\r\n  \"suggest\": {\r\n    \"text\" : \"captain usa\",\r\n    \"simple_phrase\" : {\r\n      \"phrase\" : {\r\n        \"field\" :  \"title.synonym\",\r\n        \"size\" :   1,\r\n        \"direct_generator\" : [{\r\n          \"field\" : \"title.synonym\",\r\n          \"suggest_mode\" : \"always\",\r\n          \"pre_filter\" : \"wordnet-synonym-analyzer\",\r\n          \"post_filter\" : \"wordnet-synonym-analyzer\"\r\n        }],\r\n        \"collate\": {\r\n          \"query\": { \r\n            \"source\" : {\r\n              \"match\": {\r\n                \"{{field_name}}\" : \"{{suggestion}}\" \r\n              }\r\n            }\r\n          },\r\n          \"params\": {\"field_name\" : \"title\"}, \r\n          \"prune\": true \r\n        }\r\n      }\r\n    }\r\n  }\r\n}`\r\n\r\nResponse:\r\n`{\r\n  \"error\": {\r\n    \"root_cause\": [\r\n      {\r\n        \"type\": \"illegal_state_exception\",\r\n        \"reason\": \"TokenStream contract violation: close() call missing\"\r\n      }\r\n    ],\r\n    \"type\": \"search_phase_execution_exception\",\r\n    \"reason\": \"all shards failed\",\r\n    \"phase\": \"query\",\r\n    \"grouped\": true,\r\n    \"failed_shards\": [\r\n      {\r\n        \"shard\": 0,\r\n        \"index\": \"phrase-suggester-test-index\",\r\n        \"node\": \"SKe2nqf-QSuSialfTHt2jA\",\r\n        \"reason\": {\r\n          \"type\": \"illegal_state_exception\",\r\n          \"reason\": \"TokenStream contract violation: close() call missing\"\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"status\": 500\r\n}`\r\n\r\nLogs:\r\n`[2018-05-10T12:45:11,479][WARN ][r.suppressed             ] path: /phrase-suggester-test-index/_search, params: {index=phrase-suggester-test-index}\r\norg.elasticsearch.action.search.SearchPhaseExecutionException: all shards failed\r\n\tat org.elasticsearch.action.search.AbstractSearchAsyncAction.onPhaseFailure(AbstractSearchAsyncAction.java:274) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.AbstractSearchAsyncAction.executeNextPhase(AbstractSearchAsyncAction.java:132) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.AbstractSearchAsyncAction.onPhaseDone(AbstractSearchAsyncAction.java:243) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.onShardFailure(InitialSearchPhase.java:107) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.access$100(InitialSearchPhase.java:49) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase$2.lambda$onFailure$1(InitialSearchPhase.java:217) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.maybeFork(InitialSearchPhase.java:171) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.access$000(InitialSearchPhase.java:49) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase$2.onFailure(InitialSearchPhase.java:217) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.SearchExecutionStatsCollector.onFailure(SearchExecutionStatsCollector.java:73) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.ActionListenerResponseHandler.handleException(ActionListenerResponseHandler.java:51) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.SearchTransportService$ConnectionCountingHandler.handleException(SearchTransportService.java:527) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:1098) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processException(TransportService.java:1191) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1175) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.transport.TaskTransportChannel.sendResponse(TaskTransportChannel.java:66) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.SearchTransportService$6$1.onFailure(SearchTransportService.java:385) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.SearchService$2.onFailure(SearchService.java:324) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.SearchService$2.onResponse(SearchService.java:318) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.SearchService$2.onResponse(SearchService.java:312) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.SearchService$3.doRun(SearchService.java:1002) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:672) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.common.util.concurrent.TimedRunnable.doRun(TimedRunnable.java:41) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.2.4.jar:6.2.4]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_131]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_131]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_131]\r\nCaused by: org.elasticsearch.ElasticsearchException$1: TokenStream contract violation: close() call missing\r\n\tat org.elasticsearch.ElasticsearchException.guessRootCauses(ElasticsearchException.java:619) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.SearchPhaseExecutionException.guessRootCauses(SearchPhaseExecutionException.java:170) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.SearchPhaseExecutionException.getCause(SearchPhaseExecutionException.java:111) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.apache.logging.log4j.core.impl.ThrowableProxy.<init>(ThrowableProxy.java:139) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.impl.ThrowableProxy.<init>(ThrowableProxy.java:122) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.impl.MutableLogEvent.getThrownProxy(MutableLogEvent.java:326) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.pattern.ExtendedThrowablePatternConverter.format(ExtendedThrowablePatternConverter.java:64) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.pattern.PatternFormatter.format(PatternFormatter.java:38) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.layout.PatternLayout$PatternSerializer.toSerializable(PatternLayout.java:333) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.layout.PatternLayout.toText(PatternLayout.java:232) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.layout.PatternLayout.encode(PatternLayout.java:217) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.layout.PatternLayout.encode(PatternLayout.java:57) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.directEncodeEvent(AbstractOutputStreamAppender.java:177) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.tryAppend(AbstractOutputStreamAppender.java:170) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append(AbstractOutputStreamAppender.java:161) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.config.AppenderControl.tryCallAppender(AppenderControl.java:156) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.config.AppenderControl.callAppender0(AppenderControl.java:129) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.config.AppenderControl.callAppenderPreventRecursion(AppenderControl.java:120) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.config.AppenderControl.callAppender(AppenderControl.java:84) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.config.LoggerConfig.callAppenders(LoggerConfig.java:448) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.config.LoggerConfig.processLogEvent(LoggerConfig.java:433) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:417) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:403) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.config.AwaitCompletionReliabilityStrategy.log(AwaitCompletionReliabilityStrategy.java:63) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.core.Logger.logMessage(Logger.java:146) ~[log4j-core-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.spi.ExtendedLoggerWrapper.logMessage(ExtendedLoggerWrapper.java:217) ~[log4j-api-2.9.1.jar:2.9.1]\r\n\tat org.elasticsearch.common.logging.PrefixLogger.logMessage(PrefixLogger.java:102) ~[elasticsearch-core-6.2.4.jar:6.2.4]\r\n\tat org.apache.logging.log4j.spi.AbstractLogger.tryLogMessage(AbstractLogger.java:2116) ~[log4j-api-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.spi.AbstractLogger.logMessageSafely(AbstractLogger.java:2100) ~[log4j-api-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.spi.AbstractLogger.logMessage(AbstractLogger.java:1989) ~[log4j-api-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.spi.AbstractLogger.logIfEnabled(AbstractLogger.java:1851) ~[log4j-api-2.9.1.jar:2.9.1]\r\n\tat org.apache.logging.log4j.spi.AbstractLogger.warn(AbstractLogger.java:2589) ~[log4j-api-2.9.1.jar:2.9.1]\r\n\tat org.elasticsearch.rest.BytesRestResponse.build(BytesRestResponse.java:133) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.rest.BytesRestResponse.<init>(BytesRestResponse.java:96) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.rest.BytesRestResponse.<init>(BytesRestResponse.java:91) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.rest.action.RestActionListener.onFailure(RestActionListener.java:58) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.support.TransportAction$1.onFailure(TransportAction.java:91) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.action.search.AbstractSearchAsyncAction.raisePhaseFailure(AbstractSearchAsyncAction.java:222) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\t... 28 more\r\nCaused by: java.lang.IllegalStateException: TokenStream contract violation: close() call missing\r\n\tat org.apache.lucene.analysis.Tokenizer.setReader(Tokenizer.java:90) ~[lucene-core-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:43]\r\n\tat org.apache.lucene.analysis.Analyzer$TokenStreamComponents.setReader(Analyzer.java:412) ~[lucene-core-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:43]\r\n\tat org.apache.lucene.analysis.Analyzer.tokenStream(Analyzer.java:165) ~[lucene-core-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:43]\r\n\tat org.elasticsearch.search.suggest.phrase.DirectCandidateGenerator.analyze(DirectCandidateGenerator.java:316) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.phrase.DirectCandidateGenerator.preFilter(DirectCandidateGenerator.java:149) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.phrase.DirectCandidateGenerator.frequency(DirectCandidateGenerator.java:110) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.phrase.MultiCandidateGeneratorWrapper.frequency(MultiCandidateGeneratorWrapper.java:46) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.phrase.CandidateGenerator.createCandidate(CandidateGenerator.java:40) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.phrase.NoisyChannelSpellChecker$1.nextToken(NoisyChannelSpellChecker.java:95) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.phrase.DirectCandidateGenerator.analyze(DirectCandidateGenerator.java:333) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.phrase.NoisyChannelSpellChecker.getCorrections(NoisyChannelSpellChecker.java:65) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.phrase.PhraseSuggester.innerExecute(PhraseSuggester.java:96) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.phrase.PhraseSuggester.innerExecute(PhraseSuggester.java:52) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.Suggester.execute(Suggester.java:39) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.suggest.SuggestPhase.execute(SuggestPhase.java:64) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:95) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:307) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:340) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\tat org.elasticsearch.search.SearchService$2.onResponse(SearchService.java:316) ~[elasticsearch-6.2.4.jar:6.2.4]\r\n\t... 9 more`\r\n","performed_via_github_app":null}]
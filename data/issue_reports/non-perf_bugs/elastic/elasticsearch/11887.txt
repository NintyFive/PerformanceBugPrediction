{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11887","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11887/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11887/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11887/events","html_url":"https://github.com/elastic/elasticsearch/issues/11887","id":91227042,"node_id":"MDU6SXNzdWU5MTIyNzA0Mg==","number":11887,"title":"Give _uid doc values","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":24,"created_at":"2015-06-26T11:18:31Z","updated_at":"2017-08-01T08:54:54Z","closed_at":"2017-08-01T08:54:54Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"We already use fielddata on the `_uid` field today in order to implement random sorting. However, given that doc values are disabled on `_uid`, this will use an insane amount of memory in order to load information in memory given that this field only has unique values.\n\nHaving better fielddata for `_uid` would also be useful in order to have more consistent sort order when paginating or hitting different replicas: we could always add a tie-break on the value of the `_uid` field.\n\nI think we have several options:\n- Option 1: Add SORTED doc values to `_uid`\n- Option 2: Add BINARY doc values to `_uid`\n- Option 3: Add SORTED doc values to `_type` and `_id`\n- Option 4: Add SORTED doc values to `_type` and BINARY to `_id` \n\nOption 2 would probably be wasteful in terms of disk space given that we don't have good compression available for binary doc values (and it's hard to implement given that the values can store pretty much anything).\n\nOptions 3 and 4 have the benefit of not having to duplicate information if we also want to have doc values on `_type` and `_id`: we could even build a BINARY fielddata view for `_uid`.\n\nThen the other question is whether we should rather use sorted or binary doc values, the former being better for sorting (useful for the consistent sorting use-case) and the latter being better for value lookups (useful for random sorting).\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
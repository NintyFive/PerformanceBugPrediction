[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/103825140","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-103825140","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":103825140,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMzgyNTE0MA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-05-20T09:36:25Z","updated_at":"2015-05-20T09:36:25Z","author_association":"CONTRIBUTOR","body":"++ thanks britta\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/105229794","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-105229794","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":105229794,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNTIyOTc5NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-05-25T13:13:17Z","updated_at":"2015-05-25T13:13:17Z","author_association":"CONTRIBUTOR","body":"PARTIAL_CONTENT isn't used anywhere else yet, but I'm wondering if we should, eg a search request where some shards failed?\n\nCONFLICT we only use on version conflicts atm, which i kinda like, but I agree with @nik9000 that the description indicates that it is the best fit for this condition.  That said, wondering if we should just go for a plain 400 here?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/105297074","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-105297074","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":105297074,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNTI5NzA3NA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-05-25T19:40:19Z","updated_at":"2015-05-25T19:40:19Z","author_association":"MEMBER","body":"The tricky part is that this is a multi-index operation which make it's tricky to decide what the top level rest response should be. \n\n400 is bad, because the spec explicitly says:\n\n```\nThe request could not be understood by the server due to malformed syntax. The client SHOULD NOT repeat the request without modifications.\n```\n\nespecially the later part is simply not true.\n\nSince this is all a best effort api, I would vote to keep things simple and return 200 if nothing exploded on the top level and keep the more intricate \"couldn't do  it, pending operation\" or some other shard level failure to be apparent from the response. See #11336 for proposed improved, cleaner (imho) response where there is a single counter to watch for (`_shards.failed`) which is similar to flush.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/105519376","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-105519376","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":105519376,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNTUxOTM3Ng==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-05-26T13:04:44Z","updated_at":"2015-05-26T13:04:44Z","author_association":"CONTRIBUTOR","body":"Why is w3.org down when I need it?\n\n> 400 is bad\n\n+1\n\nI don't like 200 because it means:\n\n```\nThe request has succeeded.\n```\n\nBut it didn't. I mean, I asked for a seal (or a synced flush or whatever) and it only partially worked. My first instinct with the seal command is to stick it in a `do {response = seal()} while (response != 200);` and I suspect that is what other folks will think too. I figure if a user is thinking deeply enough about the process then they can do the json parsing and figure out the response - but most users should just spin until they get a good seal.\n\nAs to the actual code - I don't care so long as it doesn't scream \"wrong!\" like 200 or 400 do to me. `CONFLICT` is fine with me. Anyone who is ok with partial seals has the wherewithall to look at the result and can distinguish a total failure from a partial one without a different http code. And conflict implies retry-able to me.\n\nIt looks like webdav uses 207 for this kind of thing. It might be ok to ape it here somewhat. Or not. Sorry for being a pain about this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/105521202","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-105521202","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":105521202,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNTUyMTIwMg==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-05-26T13:13:46Z","updated_at":"2015-05-26T13:13:46Z","author_association":"MEMBER","body":"re reading the spec for 409 conflict, it may be actually what we want:\n\n```\nThe request could not be completed due to a conflict with the current state of the resource. This code is only allowed in situations where it is expected that the user might be able to resolve the conflict and resubmit the request. The response body SHOULD include enough ...\n```\n\n99% of failed synced flush (sorry Nik :) ) will be because of concurrent indexing.\n\nI think @brwe already said she's OK with it (correct me if wrong!) . @clintongormley I think you had some reservations, but I think this is were we gravitate. Any objections left?\n\n> Sorry for being a pain about this.\n\nNot at all - These are good discussions! we take good care to choose correctly here, so users in years to come will not be confused.. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/105521757","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-105521757","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":105521757,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNTUyMTc1Nw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-05-26T13:16:05Z","updated_at":"2015-05-26T13:16:05Z","author_association":"CONTRIBUTOR","body":"> Any objections left?\n\nNone - 409 sounds like the best choice to me.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/105534392","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-105534392","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":105534392,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNTUzNDM5Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-05-26T13:59:30Z","updated_at":"2015-05-26T13:59:30Z","author_association":"CONTRIBUTOR","body":"> Why is w3.org down when I need it?\n\nThere's quite a good page on this little website called wikipedia. you may have heard of it... :)\n\nYeah, I think 409 is best.  Only for complete failure? and 206 for partial failure? Or 409 for both?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/105537419","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-105537419","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":105537419,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNTUzNzQxOQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-05-26T14:11:32Z","updated_at":"2015-05-26T14:11:32Z","author_association":"MEMBER","body":"There are indeed subtleties here:\n- a complete failure we be an exception, which will carry it's own rest status\n- a  failure that relates to an entire shard group (like no assigned primary, or in flight operation) . This will be 409.\n- a shard level failure (one replica failed to sync-flush for what ever reason). For this one I'm torn a bit but will go with 409 for simplicity to avoid 200 on error. \n\nNote that 206 is tricky to me because the spec blames it on the client:\n\n```\nThe server is delivering only part of the resource (byte serving) due to a range header sent by the client. \n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/105602861","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-105602861","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":105602861,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNTYwMjg2MQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-05-26T17:00:44Z","updated_at":"2015-05-26T17:00:44Z","author_association":"CONTRIBUTOR","body":"> There's quite a good page on this little website called wikipedia. you may have heard of it... :)\n\nI wanted to use a primary source! :)\n\n> a complete failure we be an exception, which will carry it's own rest status\n\nSure. These are mostly 5xx level stuff I imagine and for the most part should stop any automated processes until a person looks at them.\n\n> a failure that relates to an entire shard group (like no assigned primary, or in flight operation) . This will be 409.\n\n+1\n\n> a shard level failure (one replica failed to sync-flush for what ever reason). For this one I'm torn a bit but will go with 409 for simplicity to avoid 200 on error.\n\nThanks. I think 409 is best - if the user wants to get cute and say \"some of my indexes can restore slow, I don't care\" then they can issue the synced flush commands to the list of indexes they want - or they can parse the 409. I think, at least.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/106891125","html_url":"https://github.com/elastic/elasticsearch/issues/11251#issuecomment-106891125","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11251","id":106891125,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNjg5MTEyNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-05-29T18:02:09Z","updated_at":"2015-05-29T18:02:09Z","author_association":"CONTRIBUTOR","body":"Closed by #11336\n","performed_via_github_app":null}]
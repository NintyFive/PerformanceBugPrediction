{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11466","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11466/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11466/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11466/events","html_url":"https://github.com/elastic/elasticsearch/issues/11466","id":84374540,"node_id":"MDU6SXNzdWU4NDM3NDU0MA==","number":11466,"title":"Can not make requests via netcat/nc","user":{"login":"heathtechnical","id":8162329,"node_id":"MDQ6VXNlcjgxNjIzMjk=","avatar_url":"https://avatars0.githubusercontent.com/u/8162329?v=4","gravatar_id":"","url":"https://api.github.com/users/heathtechnical","html_url":"https://github.com/heathtechnical","followers_url":"https://api.github.com/users/heathtechnical/followers","following_url":"https://api.github.com/users/heathtechnical/following{/other_user}","gists_url":"https://api.github.com/users/heathtechnical/gists{/gist_id}","starred_url":"https://api.github.com/users/heathtechnical/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/heathtechnical/subscriptions","organizations_url":"https://api.github.com/users/heathtechnical/orgs","repos_url":"https://api.github.com/users/heathtechnical/repos","events_url":"https://api.github.com/users/heathtechnical/events{/privacy}","received_events_url":"https://api.github.com/users/heathtechnical/received_events","type":"User","site_admin":false},"labels":[{"id":146854632,"node_id":"MDU6TGFiZWwxNDY4NTQ2MzI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Network","name":":Distributed/Network","color":"0e8a16","default":false,"description":"Http and internode communication implementations"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-06-03T05:40:09Z","updated_at":"2015-06-03T10:00:04Z","closed_at":"2015-06-03T10:00:03Z","author_association":"NONE","active_lock_reason":null,"body":"Although not particularly useful for many folk, this one had me scratching my head for a while, this does as expected:\n\n```\n# echo -ne 'GET / HTTP/1.0\\r\\n\\r\\n' | nc localhost 9200 | head -1\nHTTP/1.0 200 OK\n```\n\nWhile this returns nothing:\n\n```\n# echo -ne 'GET /_search HTTP/1.0\\r\\n\\r\\n' | nc localhost 9200 | head -1\n```\n\nI believe this is down to Netty 3.x not supporting tcp half-closed sockets which is what is happening here (nectat closes the sender half of the socket as soon as it's done reading stdin).  Incidentally, it's strange that the first request works as expected, but I assume the response is quick enough that it is received before the sender half is shutdown.\n\nBy the looks of it Netty 4.0 has support for half-closed sockets, in the meanwhile a rather clumsy workaround is to introduce a small delay before netcat finishes with stdin:\n\n```\n(echo -ne 'GET /_search HTTP/1.0\\r\\n\\r\\n'; sleep 1) | nc localhost 9200 | head -1\nHTTP/1.0 200 OK\n```\n\nDoes this seem a reasonable explanation?\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/104742677","html_url":"https://github.com/elastic/elasticsearch/issues/11309#issuecomment-104742677","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11309","id":104742677,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNDc0MjY3Nw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-05-22T18:53:36Z","updated_at":"2015-05-22T18:53:36Z","author_association":"CONTRIBUTOR","body":"this is fixed by #11269 as of yesterday :) \n\nit will now try once this:\n\n```\n[2015-05-22 20:48:46,071][DEBUG][index                    ] [Erik Josten] [foo] [0] closed (reason: [failed recovery])\n[2015-05-22 20:48:46,072][WARN ][indices.cluster          ] [Erik Josten] [[foo][0]] marking and sending shard failed due to [failed recovery]\norg.elasticsearch.index.gateway.IndexShardGatewayRecoveryException: [foo][0] failed to fetch index version after copying it over\n    at org.elasticsearch.index.gateway.local.LocalIndexShardGateway.recover(LocalIndexShardGateway.java:158)\n    at org.elasticsearch.index.gateway.IndexShardGatewayService$1.run(IndexShardGatewayService.java:112)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: org.elasticsearch.index.gateway.IndexShardGatewayRecoveryException: [foo][0] shard allocated for local recovery (post api), should exist, but doesn't, current files: []\n    at org.elasticsearch.index.gateway.local.LocalIndexShardGateway.recover(LocalIndexShardGateway.java:132)\n    ... 4 more\nCaused by: org.apache.lucene.index.IndexNotFoundException: no segments* file found in store(least_used[rate_limited(niofs(/Users/simon/projects/elasticsearch/target/releases/elasticsearch-1.6.0-SNAPSHOT/data/elasticsearch/nodes/0/indices/foo/0/index), type=MERGE, rate=20.0)]): files: []\n    at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:881)\n    at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:769)\n    at org.apache.lucene.index.SegmentInfos.read(SegmentInfos.java:458)\n    at org.elasticsearch.common.lucene.Lucene.readSegmentInfos(Lucene.java:89)\n    at org.elasticsearch.index.store.Store.readSegmentsInfo(Store.java:166)\n    at org.elasticsearch.index.store.Store.readLastCommittedSegmentsInfo(Store.java:152)\n    at org.elasticsearch.index.gateway.local.LocalIndexShardGateway.recover(LocalIndexShardGateway.java:123)\n    ... 4 more\n```\n\nthen log this. I think we should upgrade this to a warn logging @kimchy WDYT?\n\n```\n[2015-05-22 20:48:46,135][DEBUG][gateway.local            ] [Erik Josten] [foo][0] found 0 allocations of [foo][0], node[null], [P], s[UNASSIGNED], highest version: [-1]\n\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/104746408","html_url":"https://github.com/elastic/elasticsearch/issues/11309#issuecomment-104746408","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11309","id":104746408,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNDc0NjQwOA==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2015-05-22T19:14:27Z","updated_at":"2015-05-22T19:14:27Z","author_association":"MEMBER","body":"@s1monw the tricky bit on the logging is that this might be valid, as in, when you start nodes one by one on a fresh cluster, you will get to this state, which might be valid. I wonder if the indication of shard failures is enough to indicate there is a problem with this shard if its left unassigned? There is also an option of making it info.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/104747775","html_url":"https://github.com/elastic/elasticsearch/issues/11309#issuecomment-104747775","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11309","id":104747775,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNDc0Nzc3NQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-05-22T19:22:21Z","updated_at":"2015-05-22T19:22:21Z","author_association":"CONTRIBUTOR","body":"ok fair enough\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/104752215","html_url":"https://github.com/elastic/elasticsearch/issues/11309#issuecomment-104752215","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11309","id":104752215,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNDc1MjIxNQ==","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"created_at":"2015-05-22T19:46:50Z","updated_at":"2015-05-22T19:46:50Z","author_association":"MEMBER","body":"Thanks guys!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/104869253","html_url":"https://github.com/elastic/elasticsearch/issues/11309#issuecomment-104869253","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11309","id":104869253,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNDg2OTI1Mw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-05-23T08:50:18Z","updated_at":"2015-05-23T08:50:18Z","author_association":"CONTRIBUTOR","body":"just for the record this is fixed in `1.6` & `2.0`\n","performed_via_github_app":null}]
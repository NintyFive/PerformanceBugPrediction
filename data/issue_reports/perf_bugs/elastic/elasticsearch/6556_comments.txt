[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46568418","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-46568418","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":46568418,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTY4NDE4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T14:39:08Z","updated_at":"2014-06-19T14:39:08Z","author_association":"CONTRIBUTOR","body":"@mphung I don't understand what you mean.  A Lucene BooleanQuery doesn't query words directly.  Any way that you do it, you're having to do term queries in lucene, and combine their scores with a boolean or dis_max query...\n\nI'm not surprised that 1000+ words on multiple fields is slow.  That's a lot of term lookups that it has to do.  Perhaps provide an example of what you're doing in Elasticsearch and what you are doing in Lucene?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46587012","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-46587012","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":46587012,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTg3MDEy","user":{"login":"mphung","id":7608775,"node_id":"MDQ6VXNlcjc2MDg3NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/7608775?v=4","gravatar_id":"","url":"https://api.github.com/users/mphung","html_url":"https://github.com/mphung","followers_url":"https://api.github.com/users/mphung/followers","following_url":"https://api.github.com/users/mphung/following{/other_user}","gists_url":"https://api.github.com/users/mphung/gists{/gist_id}","starred_url":"https://api.github.com/users/mphung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mphung/subscriptions","organizations_url":"https://api.github.com/users/mphung/orgs","repos_url":"https://api.github.com/users/mphung/repos","events_url":"https://api.github.com/users/mphung/events{/privacy}","received_events_url":"https://api.github.com/users/mphung/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T16:55:03Z","updated_at":"2014-06-19T16:55:03Z","author_association":"NONE","body":"Hi Clinton,\nWe're just looking to query one field with many words. For example:\n\nString queryString = \"word1 word2 word3 word998, word999, word1000\";\nTopDocsCollector<ScoreDoc> collector = TopScoreDocCollector.create(results_size, true);\nQueryParser queryParser = new QueryParser(Version.LUCENE_44, \"words_field\", new WhitespaceAnalyzer(Version.LUCENE_44));\nqueryParser.setDefaultOperator(QueryParser.OR_OPERATOR);\nQuery query = queryParser.parse(queryString); \nindexSearcher.search(query, collector);\n\nI'm using this query in ElasticSearch:\n{\n  \"query\": {\n    \"match\": {\n      \"words_field\": {\n        \"query\": \"word1 word2 word3 word998 word999 word1000\",\n        \"analyzer\": \"whitespace\",\n        \"operator\": \"or\"\n      }\n    }\n  }\n}\nMy understanding is that this will get converted to many term queries.\n\nWhen we search against Lucene directly, our latencies are around 70ms. When we search on ElasticSearch, it takes about 400ms - 500ms.\n\nThanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46588289","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-46588289","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":46588289,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTg4Mjg5","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T17:06:03Z","updated_at":"2014-06-19T17:06:03Z","author_association":"CONTRIBUTOR","body":"@mphung \n\nBoth of those queries do the same thing under the covers.  I think the differences that you are seeing have to do with (a) the fact that with the lucene example you're hitting a single Lucene index while with ES you're hitting probably 5 shards (lucene indices), and (b) you probably haven't configured Elasticsearch, eg ES_HEAP_SPACE etc.\n\nI'd ask for more information on the forum - this isn't a bug.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46589331","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-46589331","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":46589331,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTg5MzMx","user":{"login":"mphung","id":7608775,"node_id":"MDQ6VXNlcjc2MDg3NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/7608775?v=4","gravatar_id":"","url":"https://api.github.com/users/mphung","html_url":"https://github.com/mphung","followers_url":"https://api.github.com/users/mphung/followers","following_url":"https://api.github.com/users/mphung/following{/other_user}","gists_url":"https://api.github.com/users/mphung/gists{/gist_id}","starred_url":"https://api.github.com/users/mphung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mphung/subscriptions","organizations_url":"https://api.github.com/users/mphung/orgs","repos_url":"https://api.github.com/users/mphung/repos","events_url":"https://api.github.com/users/mphung/events{/privacy}","received_events_url":"https://api.github.com/users/mphung/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T17:14:19Z","updated_at":"2014-06-19T17:14:19Z","author_association":"NONE","body":"I've configured the ES_HEAP_SPACE and ElasticSearch is just running on one machine with one shard. I figured this would be most similar to one Lucene index running on one machine.  In haven't had much luck on the forums or IRC but I'll keep trying. Thanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46591232","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-46591232","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":46591232,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTkxMjMy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T17:29:45Z","updated_at":"2014-06-19T17:29:45Z","author_association":"CONTRIBUTOR","body":"Sorry, should have been ES_HEAP_SIZE... not SPACE. And you're right, one index with one shard should be similar.  Are you getting the same results?\n\nThe exact equivalent of what you're doing in Lucene would be:\n\n```\n{\n  \"query_string\": {\n    \"query\": \"word1...\",\n    \"fields\": [\"words_field\"],\n    \"analyzer\": \"whitespace\",\n    \"default_operator\": \"or\"\n  }\n}\n```\n\nbut that should translate into the same thing under the covers as the `match` query that you showed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46593013","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-46593013","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":46593013,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTkzMDEz","user":{"login":"mphung","id":7608775,"node_id":"MDQ6VXNlcjc2MDg3NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/7608775?v=4","gravatar_id":"","url":"https://api.github.com/users/mphung","html_url":"https://github.com/mphung","followers_url":"https://api.github.com/users/mphung/followers","following_url":"https://api.github.com/users/mphung/following{/other_user}","gists_url":"https://api.github.com/users/mphung/gists{/gist_id}","starred_url":"https://api.github.com/users/mphung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mphung/subscriptions","organizations_url":"https://api.github.com/users/mphung/orgs","repos_url":"https://api.github.com/users/mphung/repos","events_url":"https://api.github.com/users/mphung/events{/privacy}","received_events_url":"https://api.github.com/users/mphung/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T17:45:00Z","updated_at":"2014-06-19T17:45:00Z","author_association":"NONE","body":"Yes, the ElasticSearch queries are still significantly slower. I have the same 1 million documents in both Lucene and ElasticSearch. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46593035","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-46593035","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":46593035,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTkzMDM1","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T17:45:12Z","updated_at":"2014-06-19T17:45:12Z","author_association":"CONTRIBUTOR","body":"Hi @mphung \n\n@jpountz (one of the Lucene committers) has just had a look and says:\n\n> one difference between the two queries is that ES would go fetch some hits (even though I would be surprised that it accounts for 330ms). Otherwise I just checked that the same rewrite method would be used in both cases, and the same scorer since ES doesn't force in-order scoring.\n\nSo essentially there appears to be a difference in setup between ES and Lucene.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46594407","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-46594407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":46594407,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTk0NDA3","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T17:56:33Z","updated_at":"2014-06-19T17:56:33Z","author_association":"CONTRIBUTOR","body":"@mphung Could you verify that both indices contain as many documents, that queries return the same hit count, the same top hits and that scores are identical?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46992799","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-46992799","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":46992799,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTkyNzk5","user":{"login":"mphung","id":7608775,"node_id":"MDQ6VXNlcjc2MDg3NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/7608775?v=4","gravatar_id":"","url":"https://api.github.com/users/mphung","html_url":"https://github.com/mphung","followers_url":"https://api.github.com/users/mphung/followers","following_url":"https://api.github.com/users/mphung/following{/other_user}","gists_url":"https://api.github.com/users/mphung/gists{/gist_id}","starred_url":"https://api.github.com/users/mphung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mphung/subscriptions","organizations_url":"https://api.github.com/users/mphung/orgs","repos_url":"https://api.github.com/users/mphung/repos","events_url":"https://api.github.com/users/mphung/events{/privacy}","received_events_url":"https://api.github.com/users/mphung/received_events","type":"User","site_admin":false},"created_at":"2014-06-24T16:13:11Z","updated_at":"2014-06-24T16:13:11Z","author_association":"NONE","body":"@jpountz \nI've verified that the indices are the same and they return the same results with the same scores. When we search with a smaller number of clauses, about 100 or less, the queries are much faster with most completing in less than 20ms. We only see the increase latency with the large number of clauses.    \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47650911","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-47650911","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":47650911,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NjUwOTEx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-07-01T12:44:07Z","updated_at":"2014-07-01T12:44:07Z","author_association":"CONTRIBUTOR","body":"Would be interesting to get to the bottom of this.  @mphung could you provide as much information as possible to allow us to reproduce your test?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47683100","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-47683100","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":47683100,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NjgzMTAw","user":{"login":"mphung","id":7608775,"node_id":"MDQ6VXNlcjc2MDg3NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/7608775?v=4","gravatar_id":"","url":"https://api.github.com/users/mphung","html_url":"https://github.com/mphung","followers_url":"https://api.github.com/users/mphung/followers","following_url":"https://api.github.com/users/mphung/following{/other_user}","gists_url":"https://api.github.com/users/mphung/gists{/gist_id}","starred_url":"https://api.github.com/users/mphung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mphung/subscriptions","organizations_url":"https://api.github.com/users/mphung/orgs","repos_url":"https://api.github.com/users/mphung/repos","events_url":"https://api.github.com/users/mphung/events{/privacy}","received_events_url":"https://api.github.com/users/mphung/received_events","type":"User","site_admin":false},"created_at":"2014-07-01T17:07:10Z","updated_at":"2014-07-01T17:07:10Z","author_association":"NONE","body":"We're currently running ElasticSearch 1.1.1 on RHEL5.\n\nEach document contains 1 to 1000 unique words but most documents have 800 to 1000 words. Each word has a maximum of 15 characters. The words are separated by a space so we use the whitespace analyzer.\n\nWe just run a Boolean query with \"or\" as the operator with around 1,000 clauses.  I tested with 1 million of these documents on ElasticSearch and directly against Lucene (Version 4.4).  Please let me know if you need any more information.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/48021828","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-48021828","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":48021828,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MDIxODI4","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-07-04T08:52:44Z","updated_at":"2014-07-04T08:52:44Z","author_association":"CONTRIBUTOR","body":"Since you have lots of terms, those queries are presumably quite terms-dictionary-intensive, do you have similar numbers of segments in both indices? (On lucene just count the number of leaves and on elasticsearch you can use the [segments API](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/indices-segments.html) to figure it out.)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/48029197","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-48029197","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":48029197,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MDI5MTk3","user":{"login":"mphung","id":7608775,"node_id":"MDQ6VXNlcjc2MDg3NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/7608775?v=4","gravatar_id":"","url":"https://api.github.com/users/mphung","html_url":"https://github.com/mphung","followers_url":"https://api.github.com/users/mphung/followers","following_url":"https://api.github.com/users/mphung/following{/other_user}","gists_url":"https://api.github.com/users/mphung/gists{/gist_id}","starred_url":"https://api.github.com/users/mphung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mphung/subscriptions","organizations_url":"https://api.github.com/users/mphung/orgs","repos_url":"https://api.github.com/users/mphung/repos","events_url":"https://api.github.com/users/mphung/events{/privacy}","received_events_url":"https://api.github.com/users/mphung/received_events","type":"User","site_admin":false},"created_at":"2014-07-04T10:28:56Z","updated_at":"2014-07-04T10:28:56Z","author_association":"NONE","body":"@jpountz \nI \"optimized\" both indices before running my tests. The Lucene index has one leaf. I got this number by calling leaves() on a IndexReader object. The Elastic Search index has 24 segments.\n\n\"num_committed_segments\" : 24,\n\"num_search_segments\" : 24,\n\nI thought an optimize would combine all segments into one. Do you know why there is more than one segment?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/48054863","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-48054863","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":48054863,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MDU0ODYz","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-07-04T15:16:54Z","updated_at":"2014-07-04T15:16:54Z","author_association":"CONTRIBUTOR","body":"Did you do an optimize like this?\n\n```\nPOST /myindex/_optimize?max_num_segments=1\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/48366613","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-48366613","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":48366613,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzY2NjEz","user":{"login":"mphung","id":7608775,"node_id":"MDQ6VXNlcjc2MDg3NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/7608775?v=4","gravatar_id":"","url":"https://api.github.com/users/mphung","html_url":"https://github.com/mphung","followers_url":"https://api.github.com/users/mphung/followers","following_url":"https://api.github.com/users/mphung/following{/other_user}","gists_url":"https://api.github.com/users/mphung/gists{/gist_id}","starred_url":"https://api.github.com/users/mphung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mphung/subscriptions","organizations_url":"https://api.github.com/users/mphung/orgs","repos_url":"https://api.github.com/users/mphung/repos","events_url":"https://api.github.com/users/mphung/events{/privacy}","received_events_url":"https://api.github.com/users/mphung/received_events","type":"User","site_admin":false},"created_at":"2014-07-08T16:47:37Z","updated_at":"2014-07-08T16:47:37Z","author_association":"NONE","body":"I was using the optimize command from the \"Head\" UI. I set the maximum number of segments to 1 but now I see that this does not work through the UI. After using the command that Clinton suggested, the ElasticSearch index now has 1 segment and the search is much faster. Thanks @clintongormley and @jpountz  for all the help. One last question. Is setting  \"index.merge.policy.segments_per_tier\" to a low number the best way to achieve a low number of segments?  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/48396497","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-48396497","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":48396497,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4Mzk2NDk3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-07-08T20:38:53Z","updated_at":"2014-07-08T20:38:53Z","author_association":"CONTRIBUTOR","body":"@mphung good to hear. \n\n@mikemccand any opinion about the segments_per_tier setting?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/49424722","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-49424722","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":49424722,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDI0NzIy","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2014-07-18T12:24:40Z","updated_at":"2014-07-18T12:24:40Z","author_association":"CONTRIBUTOR","body":"Woops, I missed this...\n\nYou should lower both index.merge.policy.segments_per_tier (controls how many segments are allowed to be in the index) and index.merge.policy.max_merge_at_once (controls how many segments are merged at a time), assuming you are using tiered merge policy.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/140744015","html_url":"https://github.com/elastic/elasticsearch/issues/6556#issuecomment-140744015","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6556","id":140744015,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MDc0NDAxNQ==","user":{"login":"vorce","id":983376,"node_id":"MDQ6VXNlcjk4MzM3Ng==","avatar_url":"https://avatars3.githubusercontent.com/u/983376?v=4","gravatar_id":"","url":"https://api.github.com/users/vorce","html_url":"https://github.com/vorce","followers_url":"https://api.github.com/users/vorce/followers","following_url":"https://api.github.com/users/vorce/following{/other_user}","gists_url":"https://api.github.com/users/vorce/gists{/gist_id}","starred_url":"https://api.github.com/users/vorce/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vorce/subscriptions","organizations_url":"https://api.github.com/users/vorce/orgs","repos_url":"https://api.github.com/users/vorce/repos","events_url":"https://api.github.com/users/vorce/events{/privacy}","received_events_url":"https://api.github.com/users/vorce/received_events","type":"User","site_admin":false},"created_at":"2015-09-16T13:34:29Z","updated_at":"2015-09-16T13:34:29Z","author_association":"NONE","body":"Very interesting. We decreased the time for some nasty queries by almost 20x after optimizing one of our indices down to 1 segment. Thanks for the insight!\n","performed_via_github_app":null}]
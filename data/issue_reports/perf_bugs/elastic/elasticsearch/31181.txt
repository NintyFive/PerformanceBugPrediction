{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181/events","html_url":"https://github.com/elastic/elasticsearch/issues/31181","id":330338304,"node_id":"MDU6SXNzdWUzMzAzMzgzMDQ=","number":31181,"title":"Elasticsearch stuck after delete index request","user":{"login":"alexz00","id":26408524,"node_id":"MDQ6VXNlcjI2NDA4NTI0","avatar_url":"https://avatars3.githubusercontent.com/u/26408524?v=4","gravatar_id":"","url":"https://api.github.com/users/alexz00","html_url":"https://github.com/alexz00","followers_url":"https://api.github.com/users/alexz00/followers","following_url":"https://api.github.com/users/alexz00/following{/other_user}","gists_url":"https://api.github.com/users/alexz00/gists{/gist_id}","starred_url":"https://api.github.com/users/alexz00/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexz00/subscriptions","organizations_url":"https://api.github.com/users/alexz00/orgs","repos_url":"https://api.github.com/users/alexz00/repos","events_url":"https://api.github.com/users/alexz00/events{/privacy}","received_events_url":"https://api.github.com/users/alexz00/received_events","type":"User","site_admin":false},"labels":[{"id":145572580,"node_id":"MDU6TGFiZWwxNDU1NzI1ODA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CRUD","name":":Distributed/CRUD","color":"0e8a16","default":false,"description":"A catch all label for issues around indexing, updating and getting a doc by id. Not search."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2018-06-07T16:02:31Z","updated_at":"2018-06-21T16:46:54Z","closed_at":"2018-06-21T16:46:54Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 5.6.9\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`): 1.8.0_91\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Linux/3.10.0-327.el7.x86_64/amd64\r\n\r\n**Description of the problem including expected versus actual behavior**: Elasticsearch fails to process an index delete request and this yield to a stuckness situation: the delete-index task is queued but never processed and any other task is not processed since it is blocked by the first one.\r\n\r\n**Steps to reproduce**:\r\nWe are running an Elasticsearch instance in single node mode. It happens (randomly) that some index delete request (we are using the HTTP REST API) fails to be processed correctly, and an index-delete task is queued: we see it from the pending_tasks API.\r\n\r\nThe task is never processed, and it prevents any other task (e.g. index creation) to be executed.\r\n\r\nThe only way we found to restore normal functionality is to restart the Elasticsearch process.\r\n\r\nThe behavior we would expect is the delete request either to be successfully processed or to fail, but not to be queued forever. At least after some time we would expect the task to be removed from the queue and the subsequent tasks to be eventually processed.\r\n\r\nNote that this happens when Elasticsearch is 'at rest': it is not performing any other action, there is no incoming data and no search request running.\r\n\r\nCan you please provide some help in understanding the issue?\r\n\r\nThanks. Regards.\r\n","closed_by":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62423918","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-62423918","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":62423918,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDIzOTE4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-10T17:49:45Z","updated_at":"2014-11-10T17:49:45Z","author_association":"CONTRIBUTOR","body":"Hi @johnament\n\nHaving read through that thread, it sounds like you are not following best practices.   I'm guessing you're also creating each index with the default of 5 primary shards per index, even for this tiny dataset?\n\nHave a read of this chapter: http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/scale.html\n\nIn fact, if you're not familiar with the refresh process either, it would be useful for you to read the book from cover to cover :)\n\nAs to why there are so many instances of indexRoutingTable and IndexShardRoutingTable, I'm not sure, and will ask somebody else to comment.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62427382","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-62427382","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":62427382,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDI3Mzgy","user":{"login":"johnament","id":108167,"node_id":"MDQ6VXNlcjEwODE2Nw==","avatar_url":"https://avatars1.githubusercontent.com/u/108167?v=4","gravatar_id":"","url":"https://api.github.com/users/johnament","html_url":"https://github.com/johnament","followers_url":"https://api.github.com/users/johnament/followers","following_url":"https://api.github.com/users/johnament/following{/other_user}","gists_url":"https://api.github.com/users/johnament/gists{/gist_id}","starred_url":"https://api.github.com/users/johnament/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnament/subscriptions","organizations_url":"https://api.github.com/users/johnament/orgs","repos_url":"https://api.github.com/users/johnament/repos","events_url":"https://api.github.com/users/johnament/events{/privacy}","received_events_url":"https://api.github.com/users/johnament/received_events","type":"User","site_admin":false},"created_at":"2014-11-10T18:11:11Z","updated_at":"2014-11-10T18:11:11Z","author_association":"NONE","body":"@clintongormley I'm not sure what you're referring to.  Can you explain what you feel I'm not covering in a \"best practice\" way?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62439487","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-62439487","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":62439487,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDM5NDg3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-10T19:27:09Z","updated_at":"2014-11-10T19:27:09Z","author_association":"CONTRIBUTOR","body":"@johnament Start by reading the chapter that I linked to - it'll give you more background as to why 4,000 indices for 25k docs is a bad idea, and alternatives that you can use.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62447642","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-62447642","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":62447642,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDQ3NjQy","user":{"login":"jimmyjones2","id":2991805,"node_id":"MDQ6VXNlcjI5OTE4MDU=","avatar_url":"https://avatars2.githubusercontent.com/u/2991805?v=4","gravatar_id":"","url":"https://api.github.com/users/jimmyjones2","html_url":"https://github.com/jimmyjones2","followers_url":"https://api.github.com/users/jimmyjones2/followers","following_url":"https://api.github.com/users/jimmyjones2/following{/other_user}","gists_url":"https://api.github.com/users/jimmyjones2/gists{/gist_id}","starred_url":"https://api.github.com/users/jimmyjones2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimmyjones2/subscriptions","organizations_url":"https://api.github.com/users/jimmyjones2/orgs","repos_url":"https://api.github.com/users/jimmyjones2/repos","events_url":"https://api.github.com/users/jimmyjones2/events{/privacy}","received_events_url":"https://api.github.com/users/jimmyjones2/received_events","type":"User","site_admin":false},"created_at":"2014-11-10T20:18:07Z","updated_at":"2014-11-10T20:18:07Z","author_association":"CONTRIBUTOR","body":"@clintongormley I was trying to find what is a reasonable number of indices a while ago and couldn't find any clear guidance. Could the book contain a a rule of thumb, like more than 100 is probably a bad idea (or whatever the rough number is)? I found most monitoring tools struggled for various reasons with a large number.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62448217","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-62448217","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":62448217,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDQ4MjE3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-10T20:21:36Z","updated_at":"2014-11-10T20:21:36Z","author_association":"CONTRIBUTOR","body":"@jimmyjones2 there isn't a concrete number because it depends very much on how you use them.  I started trying to provide some guidelines, but gave up because it just didn't do the subject justice.  \n\nThe best advice comes down to: measure your hardware and your use case, and extrapolate from there.\n\nSee http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/capacity-planning.html\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62455802","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-62455802","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":62455802,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDU1ODAy","user":{"login":"jimmyjones2","id":2991805,"node_id":"MDQ6VXNlcjI5OTE4MDU=","avatar_url":"https://avatars2.githubusercontent.com/u/2991805?v=4","gravatar_id":"","url":"https://api.github.com/users/jimmyjones2","html_url":"https://github.com/jimmyjones2","followers_url":"https://api.github.com/users/jimmyjones2/followers","following_url":"https://api.github.com/users/jimmyjones2/following{/other_user}","gists_url":"https://api.github.com/users/jimmyjones2/gists{/gist_id}","starred_url":"https://api.github.com/users/jimmyjones2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimmyjones2/subscriptions","organizations_url":"https://api.github.com/users/jimmyjones2/orgs","repos_url":"https://api.github.com/users/jimmyjones2/repos","events_url":"https://api.github.com/users/jimmyjones2/events{/privacy}","received_events_url":"https://api.github.com/users/jimmyjones2/received_events","type":"User","site_admin":false},"created_at":"2014-11-10T21:11:42Z","updated_at":"2014-11-10T21:11:42Z","author_association":"CONTRIBUTOR","body":"@clintongormley I know, but people are lazy... would it be helpful to say if you want more than 100 indices you should do some testing, otherwise you'll be fine? A bit like the 5 shards thing is good for most use cases, if you want more you should think about it and test?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62478740","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-62478740","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":62478740,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNDc4NzQw","user":{"login":"johnament","id":108167,"node_id":"MDQ6VXNlcjEwODE2Nw==","avatar_url":"https://avatars1.githubusercontent.com/u/108167?v=4","gravatar_id":"","url":"https://api.github.com/users/johnament","html_url":"https://github.com/johnament","followers_url":"https://api.github.com/users/johnament/followers","following_url":"https://api.github.com/users/johnament/following{/other_user}","gists_url":"https://api.github.com/users/johnament/gists{/gist_id}","starred_url":"https://api.github.com/users/johnament/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnament/subscriptions","organizations_url":"https://api.github.com/users/johnament/orgs","repos_url":"https://api.github.com/users/johnament/repos","events_url":"https://api.github.com/users/johnament/events{/privacy}","received_events_url":"https://api.github.com/users/johnament/received_events","type":"User","site_admin":false},"created_at":"2014-11-10T23:55:21Z","updated_at":"2014-11-10T23:55:21Z","author_association":"NONE","body":"@clintongormley If I read http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/kagillion-shards.html I think you might be thinking that I'm trying this.\n\nI'm not trying this.\n\nWhat I'm trying is more akin to http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/user-based.html it's just that my initial use case has 10k users each having between 100 and 2000 documents in their store.  The reason 4200 came up was because that was as far as we could get before elasticsearch died.  Each index has fairly unique data in it, the types are generally unique per tenant (where tenant == user in the above scenario).  \n\nWhat we're actually seeing is that when the number of tenants gets to even 24, performance degrades dramatically.\n\nBased on the listed, would you then recommend maybe running a single shard per tenant?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62521326","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-62521326","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":62521326,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTIxMzI2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-11T09:21:16Z","updated_at":"2014-11-11T09:21:16Z","author_association":"CONTRIBUTOR","body":"@johnament you are indeed trying to run a kagillion shards :)  (also, you didn't mention how many nodes this is on?)\n\nEach shard has a cost - it is a lucene instance in its own right. Also, all of your 25k docs could fit easily into a single shard.  Depending on how big the docs are, how they are analyzed, and how you're searching, you could probably fit 10,000 times your current docs into a single shard quite happily.\n\nSo having 4,200 indices x 5 shards (plus replicas == 42,000 shards!) gives you about one document per primary shard!  You can see why that is an anti-pattern.\n\n(also, that number explains the 42,890 instances of IndexRoutingTable, not sure why there are 3x the number of IndexShardRoutingTable instances)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62521467","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-62521467","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":62521467,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNTIxNDY3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-11T09:22:42Z","updated_at":"2014-11-11T09:22:42Z","author_association":"CONTRIBUTOR","body":"@jimmyjones2  re:\n\n>  I know, but people are lazy... would it be helpful to say if you want more than 100 indices you should do some testing, otherwise you'll be fine? A bit like the 5 shards thing is good for most use cases, if you want more you should think about it and test?\n\nNo, the best I can say is \"it depends\", and \"you should test your use case yourself\" :)\n\nIt really does depend. People do such different things with their data that there is no one-size-fits-all rule.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135062049","html_url":"https://github.com/elastic/elasticsearch/issues/8425#issuecomment-135062049","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8425","id":135062049,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTA2MjA0OQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-08-26T15:25:29Z","updated_at":"2015-08-26T15:25:29Z","author_association":"CONTRIBUTOR","body":"Closing: too many indices will cause various problems anyway.\n","performed_via_github_app":null}]
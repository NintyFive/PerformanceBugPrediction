{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1462","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1462/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1462/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1462/events","html_url":"https://github.com/elastic/elasticsearch/issues/1462","id":2229925,"node_id":"MDU6SXNzdWUyMjI5OTI1","number":1462,"title":"Index shard search slow log (query and fetch)","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"labels":[{"id":23172,"node_id":"MDU6TGFiZWwyMzE3Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Efeature","name":">feature","color":"006b75","default":false,"description":null},{"id":175206,"node_id":"MDU6TGFiZWwxNzUyMDY=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.18.3","name":"v0.18.3","color":"DDDDDD","default":false,"description":null},{"id":174398,"node_id":"MDU6TGFiZWwxNzQzOTg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.19.0.RC1","name":"v0.19.0.RC1","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2011-11-14T12:10:02Z","updated_at":"2011-11-14T12:11:08Z","closed_at":"2011-11-14T12:11:08Z","author_association":"MEMBER","active_lock_reason":null,"body":"Shard level slow search log allows to log slow search (query and fetch executions) into a dedicated log file.\n\nThresholds can be set for both the query phase of the execution, and fetch phase, here is a sample:\n\n```\n#index.search.slowlog.threshold.query.warn: 10s\n#index.search.slowlog.threshold.query.info: 5s\n#index.search.slowlog.threshold.query.debug: 2s\n#index.search.slowlog.threshold.query.trace: 500ms\n\n#index.search.slowlog.threshold.fetch.warn: 1s\n#index.search.slowlog.threshold.fetch.info: 800ms\n#index.search.slowlog.threshold.fetch.debug: 500ms\n#index.search.slowlog.threshold.fetch.trace: 200ms\n```\n\nBy default, none are enabled (set to `-1`). Levels (`warn`, `info`, `debug`, `trace`) allow to control under which logging level the log will be logged. Not all are required to be configured (for example, only `warn` threshold can be set). The benefit of several levels is the ability to quickly \"grep\" for specific thresholds breached.\n\nThe logging is done on the shard level scope, meaning the execution of a search request within a specific shard. It does not encompass the whole search request, which can be broadcast to several shards in order to execute. Some of the benefits of shard level logging is the association of the actual execution on the specific machine, compared with request level.\n\nAll settings are index level settings (and each index can have different values for it), and can be changed in runtime using the index update settings API.\n\nThe logging file is configured by default using the following configuration (found in `logging.yml`):\n\n```\nindex_search_slow_log_file:\n  type: dailyRollingFile\n  file: ${path.logs}/${cluster.name}_index_search_slowlog.log\n  datePattern: \"'.'yyyy-MM-dd\"\n  layout:\n    type: pattern\n    conversionPattern: \"[%d{ISO8601}][%-5p][%-25c] %m%n\"\n```\n","closed_by":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/51877","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51877/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51877/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51877/events","html_url":"https://github.com/elastic/elasticsearch/issues/51877","id":559855651,"node_id":"MDU6SXNzdWU1NTk4NTU2NTE=","number":51877,"title":"Bulk request throttling issue (slow speeds compared to previous ES versions)","user":{"login":"jackpf","id":3601989,"node_id":"MDQ6VXNlcjM2MDE5ODk=","avatar_url":"https://avatars0.githubusercontent.com/u/3601989?v=4","gravatar_id":"","url":"https://api.github.com/users/jackpf","html_url":"https://github.com/jackpf","followers_url":"https://api.github.com/users/jackpf/followers","following_url":"https://api.github.com/users/jackpf/following{/other_user}","gists_url":"https://api.github.com/users/jackpf/gists{/gist_id}","starred_url":"https://api.github.com/users/jackpf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackpf/subscriptions","organizations_url":"https://api.github.com/users/jackpf/orgs","repos_url":"https://api.github.com/users/jackpf/repos","events_url":"https://api.github.com/users/jackpf/events{/privacy}","received_events_url":"https://api.github.com/users/jackpf/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-02-04T17:03:41Z","updated_at":"2020-02-07T08:21:42Z","closed_at":"2020-02-07T08:21:41Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): Version: 7.3.1, Build: default/deb/4749ba6/2019-08-19T20:19:25.651794Z, JVM: 1.8.0_131\r\n\r\n**Plugins installed**: [analysis-icu\r\nltr\r\nrepository-hdfs\r\nsearch-es-scorer-plugin\r\nsentinel-plugin]\r\n\r\n**JVM version** (`java -version`): java version \"1.8.0_131\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_131-b11)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nHi, unsure if this is a bug or intended behaviour, but we have experienced highly throttled indexing speeds since we've upgraded from ES 5.6.10 to 7.3.1.\r\n\r\nWe receive bulk request thread rejections, but we are actually only utilising around half of our available CPU, and it seems we are not able to increase the thread pool size because of this limit here: https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/threadpool/ExecutorBuilder.java#L52\r\n\r\nOur use case is that we only reindex clusters that don't receive live traffic, so I don't think this limit really makes sense for us. I wondered what the reasoning behind it was, and if other people have the same issue?\r\n\r\n**Steps to reproduce**:\r\n\r\n 1. Reindex a cluster with enough writes per second to get bulk thread rejections\r\n 2. Check if CPU is actually maxing out\r\n 3. In our case, we're only using 50% CPU\r\n","closed_by":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/22107","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22107/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22107/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22107/events","html_url":"https://github.com/elastic/elasticsearch/issues/22107","id":194899751,"node_id":"MDU6SXNzdWUxOTQ4OTk3NTE=","number":22107,"title":"restart primary node in cluster, startup very slow.","user":{"login":"ishare","id":1309607,"node_id":"MDQ6VXNlcjEzMDk2MDc=","avatar_url":"https://avatars1.githubusercontent.com/u/1309607?v=4","gravatar_id":"","url":"https://api.github.com/users/ishare","html_url":"https://github.com/ishare","followers_url":"https://api.github.com/users/ishare/followers","following_url":"https://api.github.com/users/ishare/following{/other_user}","gists_url":"https://api.github.com/users/ishare/gists{/gist_id}","starred_url":"https://api.github.com/users/ishare/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ishare/subscriptions","organizations_url":"https://api.github.com/users/ishare/orgs","repos_url":"https://api.github.com/users/ishare/repos","events_url":"https://api.github.com/users/ishare/events{/privacy}","received_events_url":"https://api.github.com/users/ishare/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-12-12T06:27:50Z","updated_at":"2016-12-12T13:11:06Z","closed_at":"2016-12-12T13:11:06Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version**: 5.0.1\r\n\r\n**Plugins installed**: [ik]\r\n\r\n**JVM version**: 1.8.0_111\r\n\r\n**OS version**: Ubuntu 16.04.1 LTS\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nJust restart primary node in cluster, sometimes it cost more than 10min to start.\r\nThe older version of es (like 1.7), do not need so much time. Is there any way to solve?\r\n\r\nAfter startup, it seems GC frequently, with logs below. But about 10 min later, it works fine.\r\n> [2016-12-12T14:23:09,078][INFO ][o.e.m.j.JvmGcMonitorService] [FaFejOC] [gc][1519] overhead, spent [315ms] collecting in the last [1s]\r\n> [2016-12-12T14:23:10,079][INFO ][o.e.m.j.JvmGcMonitorService] [FaFejOC] [gc][1520] overhead, spent [350ms] collecting in the last [1s]\r\n> [2016-12-12T14:23:11,079][INFO ][o.e.m.j.JvmGcMonitorService] [FaFejOC] [gc][1521] overhead, spent [318ms] collecting in the last [1s]\r\n> [2016-12-12T14:23:12,080][INFO ][o.e.m.j.JvmGcMonitorService] [FaFejOC] [gc][1522] overhead, spent [276ms] collecting in the last [1s]\r\n> [2016-12-12T14:23:13,085][INFO ][o.e.m.j.JvmGcMonitorService] [FaFejOC] [gc][1523] overhead, spent [318ms] collecting in the last [1s]\r\n> [2016-12-12T14:23:14,126][INFO ][o.e.m.j.JvmGcMonitorService] [FaFejOC] [gc][1524] overhead, spent [269ms] collecting in the last [1s]\r\n\r\n\r\n**Provide logs (if relevant)**:\r\n\r\noutput after type: `systemctl restart elasticsearch.service`, you can find it initializing 10 min later..\r\n\r\n> [2016-12-12T13:44:43,947][INFO ][o.e.n.Node               ] [FaFejOC] stopped\r\n> [2016-12-12T13:44:43,948][INFO ][o.e.n.Node               ] [FaFejOC] closing ...\r\n> [2016-12-12T13:44:44,062][INFO ][o.e.n.Node               ] [FaFejOC] closed\r\n> \r\n> [2016-12-12T13:57:10,647][INFO ][o.e.n.Node               ] [] initializing ...\r\n> [2016-12-12T13:57:10,821][INFO ][o.e.e.NodeEnvironment    ] [FaFejOC] using [1] data paths, mounts [[/ (/dev/sda1)]], net usable_space [11gb], net total_space [19.5gb], spins? [possibly], types [ext4]\r\n> [2016-12-12T13:57:10,822][INFO ][o.e.e.NodeEnvironment    ] [FaFejOC] heap size [15.9gb], compressed ordinary object pointers [true]\r\n> [2016-12-12T13:57:11,036][INFO ][o.e.n.Node               ] [FaFejOC] node name [FaFejOC] derived from node ID; set [node.name] to override\r\n> [2016-12-12T13:57:11,040][INFO ][o.e.n.Node               ] [FaFejOC] version[5.0.1], pid[11582], build[080bb47/2016-11-11T22:08:49.812Z], OS[Linux/4.4.0-34-generic/amd64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/1.8.0_111/25.111-b14]\r\n\r\n**elasticsearch.yml conf:**\r\n```\r\ndiscovery.zen.ping.unicast.hosts: [\"prd-es-1\", \"prd-es-2\", \"prd-es-3\"]\r\ndiscovery.zen.minimum_master_nodes: 2\r\nnode.max_local_storage_nodes: 1\r\nbootstrap.memory_lock: true\r\n```\r\n\r\n```\r\n## GC configuration\r\n-XX:+UseConcMarkSweepGC\r\n-XX:CMSInitiatingOccupancyFraction=75\r\n-XX:+UseCMSInitiatingOccupancyOnly\r\n\r\n-Xms16g\r\n-Xmx16g\r\n```","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
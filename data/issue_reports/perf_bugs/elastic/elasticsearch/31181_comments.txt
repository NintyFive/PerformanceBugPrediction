[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/395543712","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-395543712","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":395543712,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTU0MzcxMg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-06-07T19:51:25Z","updated_at":"2018-06-07T19:51:25Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/396075260","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-396075260","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":396075260,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjA3NTI2MA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-06-10T19:31:58Z","updated_at":"2018-06-10T19:31:58Z","author_association":"MEMBER","body":"@alexz00 do you mind sharing your pending tasks lists when that happens (json format please, it has more info). Can you also share hot threads on the master nodes - I'm curios to see what the thread called `clusterService#updateTask` is doing.  See [here](https://www.elastic.co/guide/en/elasticsearch/reference/5.6/cluster-nodes-hot-threads.html) for documentation. You might need to tweak parameters to get it to show. Last if you have anything in the logs you think is relevant, please share.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/396075980","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-396075980","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":396075980,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjA3NTk4MA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-06-10T19:40:42Z","updated_at":"2018-06-10T19:40:42Z","author_association":"MEMBER","body":"> Can you also share hot threads on the master nodes - I'm curios to see what the thread called `clusterService#updateTask` is doing.  See [here](https://www.elastic.co/guide/en/elasticsearch/reference/5.6/cluster-nodes-hot-threads.html) for documentation. You might need to tweak parameters to get it to show.\r\n\r\nIn this case I think that `jstack` would be better if the JDK is installed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/396523954","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-396523954","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":396523954,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjUyMzk1NA==","user":{"login":"alexz00","id":26408524,"node_id":"MDQ6VXNlcjI2NDA4NTI0","avatar_url":"https://avatars3.githubusercontent.com/u/26408524?v=4","gravatar_id":"","url":"https://api.github.com/users/alexz00","html_url":"https://github.com/alexz00","followers_url":"https://api.github.com/users/alexz00/followers","following_url":"https://api.github.com/users/alexz00/following{/other_user}","gists_url":"https://api.github.com/users/alexz00/gists{/gist_id}","starred_url":"https://api.github.com/users/alexz00/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexz00/subscriptions","organizations_url":"https://api.github.com/users/alexz00/orgs","repos_url":"https://api.github.com/users/alexz00/repos","events_url":"https://api.github.com/users/alexz00/events{/privacy}","received_events_url":"https://api.github.com/users/alexz00/received_events","type":"User","site_admin":false},"created_at":"2018-06-12T09:19:19Z","updated_at":"2018-06-12T09:19:19Z","author_association":"NONE","body":"Unfortunately the Elasticsearch instance that caused this problem is deployed at a customer, and I've not direct access to it. We have a basic monitoring infrastructure that collects periodically information, this is what I can provide you at the moment:\r\n\r\n> Elasticsearch {INFO} Action {Dumping pending task data} InsertOrder {1877} Priority {URGENT} Source {delete-index [[myindexa-2018.05.31/ISUt985ZQuizk86hpki5gA]]} TimeInQueue {1480984}\r\nElasticsearch {INFO} Action {Dumping pending task data} InsertOrder {1878} Priority {URGENT} Source {delete-index [[myindexb-2018.05.31/L2RVa98xRa2NvteS_oT1EQ]]} TimeInQueue {880359}\r\nElasticsearch {INFO} Action {Dumping pending task data} InsertOrder {1879} Priority {URGENT} Source {delete-index [[myindexc-2018.05.31/Kswk6DGXRMSB4bs_ON7_DA]]} TimeInQueue {279731}\r\nElasticsearch {INFO} Action {Hot Threads} HotThreadsDump {::: {MYAPP}{fZ_dw6hbQtqZ705pzah14Q}{2XQyjxFRTseILjucudDOQw}{10.202.101.247}{10.202.101.247:9300}\r\n   Hot threads at 2018-06-07T04:24:55.840Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:\r\n}\r\n\r\nThat is, a dump of the pending tasks and the hot threads in the applicative logs.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/398764699","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-398764699","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":398764699,"node_id":"MDEyOklzc3VlQ29tbWVudDM5ODc2NDY5OQ==","user":{"login":"alexz00","id":26408524,"node_id":"MDQ6VXNlcjI2NDA4NTI0","avatar_url":"https://avatars3.githubusercontent.com/u/26408524?v=4","gravatar_id":"","url":"https://api.github.com/users/alexz00","html_url":"https://github.com/alexz00","followers_url":"https://api.github.com/users/alexz00/followers","following_url":"https://api.github.com/users/alexz00/following{/other_user}","gists_url":"https://api.github.com/users/alexz00/gists{/gist_id}","starred_url":"https://api.github.com/users/alexz00/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexz00/subscriptions","organizations_url":"https://api.github.com/users/alexz00/orgs","repos_url":"https://api.github.com/users/alexz00/repos","events_url":"https://api.github.com/users/alexz00/events{/privacy}","received_events_url":"https://api.github.com/users/alexz00/received_events","type":"User","site_admin":false},"created_at":"2018-06-20T14:14:14Z","updated_at":"2018-06-20T14:14:14Z","author_association":"NONE","body":"We had a similar issue while indexing some data. Brief description of the scenario:\r\n- Data were pushed by Logstash\r\n- We tried to index ~700k events (3.5GB of disk space for ES indices)\r\n- The index requests triggered the creation of ~50 different indices, 5 shards per index\r\n- We are running our tests on an AWS EC2 M4 4xlarge instance (16cores, 64GB, EBS volumes). Elasticsearch heap size is 16GB.\r\n\r\nAfter some minutes after we started the process, ES stopped to index data and to create new indices. We started to see errors like the following:\r\n\r\n> ... [o.e.i.IndexingMemoryController] ... now throttling indexing for shard [[indexname][4]]: segment writing can't keep up\r\n> ... [o.e.i.IndexingMemoryController] ... stop throttling indexing for shard [[indexname][1]]\r\n\r\nThen Elasticsearch began to queue pending tasks without processing them.\r\n\r\nWe had to restart Elasticsearch to have the process completed with success.\r\nI understand that we pushed a lot of data in a short time frame, and therefore it is absolutely reasonable to have a slowdown of the indexing process.\r\nBut what we see is that after the congestion situation, Elasticsearch became stuck, and it is never able to recover, while our expectation is that, after some time, it should recover and complete the indexing of all the documents.\r\nI think it worth noting that after ES started queueing the tasks, it's CPU consumption was very low.\r\n\r\nI attach the following:\r\n- A thread dump generated with jstack\r\n- The output of the hot threads, pending tasks and node stats ES APIs.\r\n\r\nCan someone help us in understanding what is happening and if/how is possible to address these situations (we'd like to avoid to restart Elasticsearch every time...)\r\n\r\nLet me know if you need some additional information.\r\nThank you very much.\r\n\r\n[nodes_stats.txt](https://github.com/elastic/elasticsearch/files/2119669/nodes_stats.txt)\r\n[jstack.log](https://github.com/elastic/elasticsearch/files/2119667/jstack.log)\r\n[hot_threads.log](https://github.com/elastic/elasticsearch/files/2119668/hot_threads.log)\r\n[pending_tasks.log](https://github.com/elastic/elasticsearch/files/2119671/pending_tasks.log)\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399024440","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-399024440","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":399024440,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTAyNDQ0MA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T08:44:04Z","updated_at":"2018-06-21T08:44:04Z","author_association":"CONTRIBUTOR","body":"Based on the hot_threads output (see below), it looks like your node is stuck on logging output, which is causing the cluster state thread to hang (occurrence 1 below) and indexing to be forever throttled (occurrence 2 below). Can you provide your logging configuration?\r\n\r\n```\r\n0.0% (14.9micros out of 500ms) cpu usage by thread 'elasticsearch[MYNODE][clusterService#updateTask][T#1]'\r\n     10/10 snapshots sharing following 41 elements\r\n       org.apache.logging.log4j.core.appender.OutputStreamManager.writeBytes(OutputStreamManager.java:360)\r\n       org.apache.logging.log4j.core.layout.TextEncoderHelper.writeEncodedText(TextEncoderHelper.java:96)\r\n       org.apache.logging.log4j.core.layout.TextEncoderHelper.encodeText(TextEncoderHelper.java:65)\r\n       org.apache.logging.log4j.core.layout.StringBuilderEncoder.encode(StringBuilderEncoder.java:68)\r\n       org.apache.logging.log4j.core.layout.StringBuilderEncoder.encode(StringBuilderEncoder.java:32)\r\n       org.apache.logging.log4j.core.layout.PatternLayout.encode(PatternLayout.java:219)\r\n       org.apache.logging.log4j.core.layout.PatternLayout.encode(PatternLayout.java:57)\r\n       org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.directEncodeEvent(AbstractOutputStreamAppender.java:177)\r\n       org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.tryAppend(AbstractOutputStreamAppender.java:170)\r\n       org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append(AbstractOutputStreamAppender.java:161)\r\n       org.apache.logging.log4j.core.config.AppenderControl.tryCallAppender(AppenderControl.java:156)\r\n       org.apache.logging.log4j.core.config.AppenderControl.callAppender0(AppenderControl.java:129)\r\n       org.apache.logging.log4j.core.config.AppenderControl.callAppenderPreventRecursion(AppenderControl.java:120)\r\n       org.apache.logging.log4j.core.config.AppenderControl.callAppender(AppenderControl.java:84)\r\n       org.apache.logging.log4j.core.config.LoggerConfig.callAppenders(LoggerConfig.java:448)\r\n       org.apache.logging.log4j.core.config.LoggerConfig.processLogEvent(LoggerConfig.java:433)\r\n       org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:417)\r\n       org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:403)\r\n       org.apache.logging.log4j.core.config.AwaitCompletionReliabilityStrategy.log(AwaitCompletionReliabilityStrategy.java:63)\r\n       org.apache.logging.log4j.core.Logger.logMessage(Logger.java:146)\r\n       org.apache.logging.log4j.spi.ExtendedLoggerWrapper.logMessage(ExtendedLoggerWrapper.java:217)\r\n       org.elasticsearch.common.logging.PrefixLogger.logMessage(PrefixLogger.java:102)\r\n       org.apache.logging.log4j.spi.AbstractLogger.tryLogMessage(AbstractLogger.java:2116)\r\n       org.apache.logging.log4j.spi.AbstractLogger.logMessageSafely(AbstractLogger.java:2100)\r\n       org.apache.logging.log4j.spi.AbstractLogger.logMessage(AbstractLogger.java:2048)\r\n       org.apache.logging.log4j.spi.AbstractLogger.logIfEnabled(AbstractLogger.java:1931)\r\n       org.apache.logging.log4j.spi.AbstractLogger.info(AbstractLogger.java:1460)\r\n       org.elasticsearch.cluster.metadata.MetaDataCreateIndexService$1.execute(MetaDataCreateIndexService.java:454)\r\n       org.elasticsearch.cluster.ClusterStateUpdateTask.execute(ClusterStateUpdateTask.java:45)\r\n       org.elasticsearch.cluster.service.ClusterService.executeTasks(ClusterService.java:634)\r\n       org.elasticsearch.cluster.service.ClusterService.calculateTaskOutputs(ClusterService.java:612)\r\n       org.elasticsearch.cluster.service.ClusterService.runTasks(ClusterService.java:571)\r\n       org.elasticsearch.cluster.service.ClusterService$ClusterServiceTaskBatcher.run(ClusterService.java:263)\r\n       org.elasticsearch.cluster.service.TaskBatcher.runIfNotProcessed(TaskBatcher.java:150)\r\n       org.elasticsearch.cluster.service.TaskBatcher$BatchedTask.run(TaskBatcher.java:188)\r\n       org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:575)\r\n       org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:247)\r\n       org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:210)\r\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n       java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\n```\r\n0.0% (0s out of 500ms) cpu usage by thread 'elasticsearch[MYNODE][scheduler][T#1]'\r\n     10/10 snapshots sharing following 40 elements\r\n       java.io.FileOutputStream.writeBytes(Native Method)\r\n       java.io.FileOutputStream.write(FileOutputStream.java:326)\r\n       java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)\r\n       java.io.PrintStream.write(PrintStream.java:480)\r\n       org.apache.logging.log4j.core.util.CloseShieldOutputStream.write(CloseShieldOutputStream.java:53)\r\n       org.apache.logging.log4j.core.appender.OutputStreamManager.writeToDestination(OutputStreamManager.java:262)\r\n       org.apache.logging.log4j.core.appender.OutputStreamManager.flushBuffer(OutputStreamManager.java:294)\r\n       org.apache.logging.log4j.core.appender.OutputStreamManager.flush(OutputStreamManager.java:303)\r\n       org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.directEncodeEvent(AbstractOutputStreamAppender.java:179)\r\n       org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.tryAppend(AbstractOutputStreamAppender.java:170)\r\n       org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append(AbstractOutputStreamAppender.java:161)\r\n       org.apache.logging.log4j.core.config.AppenderControl.tryCallAppender(AppenderControl.java:156)\r\n       org.apache.logging.log4j.core.config.AppenderControl.callAppender0(AppenderControl.java:129)\r\n       org.apache.logging.log4j.core.config.AppenderControl.callAppenderPreventRecursion(AppenderControl.java:120)\r\n       org.apache.logging.log4j.core.config.AppenderControl.callAppender(AppenderControl.java:84)\r\n       org.apache.logging.log4j.core.config.LoggerConfig.callAppenders(LoggerConfig.java:448)\r\n       org.apache.logging.log4j.core.config.LoggerConfig.processLogEvent(LoggerConfig.java:433)\r\n       org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:417)\r\n       org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:403)\r\n       org.apache.logging.log4j.core.config.AwaitCompletionReliabilityStrategy.log(AwaitCompletionReliabilityStrategy.java:63)\r\n       org.apache.logging.log4j.core.Logger.logMessage(Logger.java:146)\r\n       org.apache.logging.log4j.spi.ExtendedLoggerWrapper.logMessage(ExtendedLoggerWrapper.java:217)\r\n       org.elasticsearch.common.logging.PrefixLogger.logMessage(PrefixLogger.java:102)\r\n       org.apache.logging.log4j.spi.AbstractLogger.tryLogMessage(AbstractLogger.java:2116)\r\n       org.apache.logging.log4j.spi.AbstractLogger.logMessageSafely(AbstractLogger.java:2100)\r\n       org.apache.logging.log4j.spi.AbstractLogger.logMessage(AbstractLogger.java:2011)\r\n       org.apache.logging.log4j.spi.AbstractLogger.logIfEnabled(AbstractLogger.java:1882)\r\n       org.apache.logging.log4j.spi.AbstractLogger.info(AbstractLogger.java:1427)\r\n       org.elasticsearch.indices.IndexingMemoryController$ShardsIndicesStatusChecker.runUnlocked(IndexingMemoryController.java:373)\r\n       org.elasticsearch.indices.IndexingMemoryController$ShardsIndicesStatusChecker.run(IndexingMemoryController.java:277)\r\n       org.elasticsearch.threadpool.ThreadPool$ReschedulingRunnable.doRun(ThreadPool.java:811)\r\n       org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.threadpool.ThreadPool$LoggingRunnable.run(ThreadPool.java:436)\r\n       java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n       java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n       java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\r\n       java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\r\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n       java.lang.Thread.run(Thread.java:748)\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399063022","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-399063022","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":399063022,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTA2MzAyMg==","user":{"login":"alexz00","id":26408524,"node_id":"MDQ6VXNlcjI2NDA4NTI0","avatar_url":"https://avatars3.githubusercontent.com/u/26408524?v=4","gravatar_id":"","url":"https://api.github.com/users/alexz00","html_url":"https://github.com/alexz00","followers_url":"https://api.github.com/users/alexz00/followers","following_url":"https://api.github.com/users/alexz00/following{/other_user}","gists_url":"https://api.github.com/users/alexz00/gists{/gist_id}","starred_url":"https://api.github.com/users/alexz00/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexz00/subscriptions","organizations_url":"https://api.github.com/users/alexz00/orgs","repos_url":"https://api.github.com/users/alexz00/repos","events_url":"https://api.github.com/users/alexz00/events{/privacy}","received_events_url":"https://api.github.com/users/alexz00/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T11:01:34Z","updated_at":"2018-06-21T11:01:34Z","author_association":"NONE","body":"Yes, of course.\r\nI'll attach the log4j2.properties.\r\n\r\nThanks.\r\n\r\n[log4j2.zip](https://github.com/elastic/elasticsearch/files/2123271/log4j2.zip)\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399163401","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-399163401","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":399163401,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTE2MzQwMQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T16:25:08Z","updated_at":"2018-06-21T16:25:08Z","author_association":"CONTRIBUTOR","body":"Are you logging to local disks or directly to the EBS volume?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399168076","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-399168076","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":399168076,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTE2ODA3Ng==","user":{"login":"alexz00","id":26408524,"node_id":"MDQ6VXNlcjI2NDA4NTI0","avatar_url":"https://avatars3.githubusercontent.com/u/26408524?v=4","gravatar_id":"","url":"https://api.github.com/users/alexz00","html_url":"https://github.com/alexz00","followers_url":"https://api.github.com/users/alexz00/followers","following_url":"https://api.github.com/users/alexz00/following{/other_user}","gists_url":"https://api.github.com/users/alexz00/gists{/gist_id}","starred_url":"https://api.github.com/users/alexz00/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexz00/subscriptions","organizations_url":"https://api.github.com/users/alexz00/orgs","repos_url":"https://api.github.com/users/alexz00/repos","events_url":"https://api.github.com/users/alexz00/events{/privacy}","received_events_url":"https://api.github.com/users/alexz00/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T16:40:17Z","updated_at":"2018-06-21T16:40:17Z","author_association":"NONE","body":"The environment is a bit non standard, indeed.\r\nMy environment is running inside Docker, and I'm logging on a volume mounted in the container from the EBS volume.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399169967","html_url":"https://github.com/elastic/elasticsearch/issues/31181#issuecomment-399169967","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31181","id":399169967,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTE2OTk2Nw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T16:46:54Z","updated_at":"2018-06-21T16:46:54Z","author_association":"CONTRIBUTOR","body":"Something is blocking the writes to the log files on the EBS volume, which in turn blocks the logger, which in turn hangs important threads in ES, which results in the stuckness that you're seeing. There's nothing we can do here on the ES side of things. As such, I'm closing this issue.","performed_via_github_app":null}]
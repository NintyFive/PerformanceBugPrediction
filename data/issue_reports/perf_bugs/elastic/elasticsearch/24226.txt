{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24226","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24226/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24226/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24226/events","html_url":"https://github.com/elastic/elasticsearch/issues/24226","id":223193274,"node_id":"MDU6SXNzdWUyMjMxOTMyNzQ=","number":24226,"title":"Static code analysis shows a whole bunch of performance/memory optimization possibilities, would this be appreciated.","user":{"login":"KoenDG","id":1440619,"node_id":"MDQ6VXNlcjE0NDA2MTk=","avatar_url":"https://avatars3.githubusercontent.com/u/1440619?v=4","gravatar_id":"","url":"https://api.github.com/users/KoenDG","html_url":"https://github.com/KoenDG","followers_url":"https://api.github.com/users/KoenDG/followers","following_url":"https://api.github.com/users/KoenDG/following{/other_user}","gists_url":"https://api.github.com/users/KoenDG/gists{/gist_id}","starred_url":"https://api.github.com/users/KoenDG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KoenDG/subscriptions","organizations_url":"https://api.github.com/users/KoenDG/orgs","repos_url":"https://api.github.com/users/KoenDG/repos","events_url":"https://api.github.com/users/KoenDG/events{/privacy}","received_events_url":"https://api.github.com/users/KoenDG/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2017-04-20T20:41:04Z","updated_at":"2017-05-19T17:19:04Z","closed_at":"2017-05-01T01:29:03Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I asked on the IRC what the best way to approach this is, and \"just post an issue and ask\" was it. So here goes. I was told there will be no biting :P\r\n\r\nI forked the project, had Intellij do its static code analysis on it and it had a whole bunch of results under the performance/memory issue categories. These are small and relatively bigger things, depending on the situation.\r\n\r\nThese are things like: using the `keySet()` of a Map to loop over it, which is very inefficient since every single `.get()` you do will force the JVM to create a new Iterator internally to loop over the map again and go get the value. Looping via the `entrySet()` avoids this.\r\n\r\nThings like not using an EnumMap when the key of a Map is an Enum. EnumMap is specifically made for this scenario and uses a primitive array internally, making it a lot smaller in memory and faster in all cases, compared to all other Map implementations.\r\n\r\nAnd a lot more, too much to list here. And that's just the performance/memory stuff.\r\n\r\nNow, ElasticSearch is a gigantic project and the resources on who can help where are understandably constrained. So I'm offering to contribute in this manner. It's my way of browsing the code and learning how it works, while at the same time I can contribute some things.\r\n\r\nWould this be appreciated/wanted/accepted? Perhaps it could be something in that \"projects\" tab where the smaller things are stated to go. General cleanup and code optimizations.\r\n\r\nJust to give an idea, analyzing just the `core` folder of the source code took Intellij about 4 and a half hours to complete on a 3.4GHz desktop CPU, 4 cores 8 threads. On a limited scanning profile. About half the options were turned off.\r\n\r\nThanks for your time reading this, I hope I can help out in this way.","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
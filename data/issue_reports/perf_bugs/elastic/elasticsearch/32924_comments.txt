[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413673846","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413673846","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413673846,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzY3Mzg0Ng==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-08-16T20:26:36Z","updated_at":"2018-08-16T20:26:36Z","author_association":"MEMBER","body":"@danielkasen Can you share with us the recovery stats? You can get it by `GET /_recovery`. Thanks.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413673918","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413673918","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413673918,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzY3MzkxOA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-08-16T20:26:49Z","updated_at":"2018-08-16T20:26:49Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413718627","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413718627","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413718627,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzcxODYyNw==","user":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"created_at":"2018-08-16T23:58:01Z","updated_at":"2018-08-16T23:58:01Z","author_association":"NONE","body":"```{\r\n  \"test-2018.08.16.20.15-1\": {\r\n    \"shards\": [\r\n      {\r\n        \"id\": 24,\r\n        \"type\": \"PEER\",\r\n        \"stage\": \"TRANSLOG\",\r\n        \"primary\": false,\r\n        \"start_time\": \"2018-08-16T23:01:47.323Z\",\r\n        \"start_time_in_millis\": 1534460507323,\r\n        \"total_time\": \"54.3m\",\r\n        \"total_time_in_millis\": 3259899,\r\n        \"source\": {\r\n          \"id\": \"Z2zhHgzsRduWQh5TAgXYOA\",\r\n          \"host\": \"ip-10-0-77.41.ap-southeast-1.compute.internal\",\r\n          \"transport_address\": \"10.0.77.41:9300\",\r\n          \"ip\": \"10.0.77.41\",\r\n          \"name\": \"i-04e5e9a72be7b6d3e\"\r\n        },\r\n        \"target\": {\r\n          \"id\": \"5mhfEJsASVyTBrRslIOOpQ\",\r\n          \"host\": \"ip-10-0-59-250.ap-southeast-1.compute.internal\",\r\n          \"transport_address\": \"10.0.59.250:9300\",\r\n          \"ip\": \"10.0.59.250\",\r\n          \"name\": \"i-0dc683029ed922ab6\"\r\n        },\r\n        \"index\": {\r\n          \"size\": {\r\n            \"total\": \"33.6gb\",\r\n            \"total_in_bytes\": 36097975075,\r\n            \"reused\": \"0b\",\r\n            \"reused_in_bytes\": 0,\r\n            \"recovered\": \"33.6gb\",\r\n            \"recovered_in_bytes\": 36097975075,\r\n            \"percent\": \"100.0%\"\r\n          },\r\n          \"files\": {\r\n            \"total\": 243,\r\n            \"reused\": 0,\r\n            \"recovered\": 243,\r\n            \"percent\": \"100.0%\"\r\n          },\r\n          \"total_time\": \"23.2m\",\r\n          \"total_time_in_millis\": 1395463,\r\n          \"source_throttle_time\": \"0s\",\r\n          \"source_throttle_time_in_millis\": 0,\r\n          \"target_throttle_time\": \"0s\",\r\n          \"target_throttle_time_in_millis\": 0\r\n        },\r\n        \"translog\": {\r\n          \"recovered\": 4797934,\r\n          \"total\": 29997597,\r\n          \"percent\": \"16.0%\",\r\n          \"total_on_start\": 1972667,\r\n          \"total_time\": \"31m\",\r\n          \"total_time_in_millis\": 1864433\r\n        },\r\n        \"verify_index\": {\r\n          \"check_index_time\": \"0s\",\r\n          \"check_index_time_in_millis\": 0,\r\n          \"total_time\": \"0s\",\r\n          \"total_time_in_millis\": 0\r\n        }\r\n    }\r\n}```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413724783","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413724783","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413724783,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzcyNDc4Mw==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T00:42:40Z","updated_at":"2018-08-17T00:42:40Z","author_association":"MEMBER","body":"```\r\n\"translog\": {\r\n  \"recovered\": 4797934,\r\n  \"total\": 29997597,\r\n  \"percent\": \"16.0%\",\r\n  \"total_on_start\": 1972667,\r\n  \"total_time\": \"31m\",\r\n  \"total_time_in_millis\": 1864433\r\n}\r\n```\r\n\r\n@danielkasen There might be something wrong with your index. Can you share with us the shard-level stats of the offending shard via `GET _stats?level=shards`? Thank you!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413725006","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413725006","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413725006,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzcyNTAwNg==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T00:44:27Z","updated_at":"2018-08-17T00:44:27Z","author_association":"MEMBER","body":"@danielkasen Was this index created on v6.3.2 or before?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413728361","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413728361","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413728361,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzcyODM2MQ==","user":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T01:10:13Z","updated_at":"2018-08-17T01:10:13Z","author_association":"NONE","body":"I trimmed it up a little:\r\n\r\n```    \"test-2018.08.16.20.15-1\": {\r\n      \"primaries\": {\r\n        \"docs\": {\r\n          \"count\": 4696689817,\r\n          \"deleted\": 0\r\n        },\r\n        \"store\": {\r\n          \"size_in_bytes\": 2507392614774\r\n        },\r\n        \"indexing\": {\r\n          \"index_total\": 4693250300,\r\n          \"index_time_in_millis\": 1482198324,\r\n          \"index_current\": 0,\r\n          \"index_failed\": 0,\r\n          \"delete_total\": 0,\r\n          \"delete_time_in_millis\": 0,\r\n          \"delete_current\": 0,\r\n          \"noop_update_total\": 0,\r\n          \"is_throttled\": false,\r\n          \"throttle_time_in_millis\": 3624\r\n        },\r\n        \"get\": {\r\n          \"total\": 0,\r\n          \"time_in_millis\": 0,\r\n          \"exists_total\": 0,\r\n          \"exists_time_in_millis\": 0,\r\n          \"missing_total\": 0,\r\n          \"missing_time_in_millis\": 0,\r\n          \"current\": 0\r\n        },\r\n        \"search\": {\r\n          \"open_contexts\": 0,\r\n          \"query_total\": 19055,\r\n          \"query_time_in_millis\": 771671,\r\n          \"query_current\": 0,\r\n          \"fetch_total\": 6868,\r\n          \"fetch_time_in_millis\": 99170,\r\n          \"fetch_current\": 0,\r\n          \"scroll_total\": 0,\r\n          \"scroll_time_in_millis\": 0,\r\n          \"scroll_current\": 0,\r\n          \"suggest_total\": 0,\r\n          \"suggest_time_in_millis\": 0,\r\n          \"suggest_current\": 0\r\n        },\r\n        \"merges\": {\r\n          \"current\": 0,\r\n          \"current_docs\": 0,\r\n          \"current_size_in_bytes\": 0,\r\n          \"total\": 558008,\r\n          \"total_time_in_millis\": 1144008437,\r\n          \"total_docs\": 18842441816,\r\n          \"total_size_in_bytes\": 11946457504271,\r\n          \"total_stopped_time_in_millis\": 663578,\r\n          \"total_throttled_time_in_millis\": 539275685,\r\n          \"total_auto_throttle_in_bytes\": 2474063346\r\n        },\r\n        \"refresh\": {\r\n          \"total\": 476923,\r\n          \"total_time_in_millis\": 43048206,\r\n          \"listeners\": 0\r\n        },\r\n        \"flush\": {\r\n          \"total\": 1931,\r\n          \"periodic\": 1530,\r\n          \"total_time_in_millis\": 1259204\r\n        },\r\n        \"warmer\": {\r\n          \"current\": 0,\r\n          \"total\": 474858,\r\n          \"total_time_in_millis\": 13279\r\n        },\r\n        \"query_cache\": {\r\n          \"memory_size_in_bytes\": 551969373,\r\n          \"total_count\": 3945739,\r\n          \"hit_count\": 60815,\r\n          \"miss_count\": 3884924,\r\n          \"cache_size\": 2509,\r\n          \"cache_count\": 4280,\r\n          \"evictions\": 1771\r\n        },\r\n        \"fielddata\": {\r\n          \"memory_size_in_bytes\": 181832,\r\n          \"evictions\": 0\r\n        },\r\n        \"completion\": {\r\n          \"size_in_bytes\": 0\r\n        },\r\n        \"segments\": {\r\n          \"count\": 1646,\r\n          \"memory_in_bytes\": 6838966702,\r\n          \"terms_memory_in_bytes\": 6566645884,\r\n          \"stored_fields_memory_in_bytes\": 192830040,\r\n          \"term_vectors_memory_in_bytes\": 0,\r\n          \"norms_memory_in_bytes\": 432256,\r\n          \"points_memory_in_bytes\": 78520378,\r\n          \"doc_values_memory_in_bytes\": 538144,\r\n          \"index_writer_memory_in_bytes\": 0,\r\n          \"version_map_memory_in_bytes\": 0,\r\n          \"fixed_bit_set_memory_in_bytes\": 0,\r\n          \"max_unsafe_auto_id_timestamp\": 1534460344075,\r\n          \"file_sizes\": {}\r\n        },\r\n        \"translog\": {\r\n          \"operations\": 475867744,\r\n          \"size_in_bytes\": 357659107882,\r\n          \"uncommitted_operations\": 0,\r\n          \"uncommitted_size_in_bytes\": 2475,\r\n          \"earliest_last_modified_age\": 0\r\n        },\r\n        \"request_cache\": {\r\n          \"memory_size_in_bytes\": 41324,\r\n          \"evictions\": 0,\r\n          \"hit_count\": 0,\r\n          \"miss_count\": 149\r\n        },\r\n        \"recovery\": {\r\n          \"current_as_source\": 13,\r\n          \"current_as_target\": 0,\r\n          \"throttle_time_in_millis\": 199\r\n        }\r\n      },\r\n      \"total\": {\r\n        \"docs\": {\r\n          \"count\": 12733248842,\r\n          \"deleted\": 0\r\n        },\r\n        \"store\": {\r\n          \"size_in_bytes\": 6801037835462\r\n        },\r\n        \"indexing\": {\r\n          \"index_total\": 12182770492,\r\n          \"index_time_in_millis\": 3681619914,\r\n          \"index_current\": 0,\r\n          \"index_failed\": 0,\r\n          \"delete_total\": 0,\r\n          \"delete_time_in_millis\": 0,\r\n          \"delete_current\": 0,\r\n          \"noop_update_total\": 0,\r\n          \"is_throttled\": false,\r\n          \"throttle_time_in_millis\": 8217\r\n        },\r\n        \"get\": {\r\n          \"total\": 0,\r\n          \"time_in_millis\": 0,\r\n          \"exists_total\": 0,\r\n          \"exists_time_in_millis\": 0,\r\n          \"missing_total\": 0,\r\n          \"missing_time_in_millis\": 0,\r\n          \"current\": 0\r\n        },\r\n        \"search\": {\r\n          \"open_contexts\": 0,\r\n          \"query_total\": 48636,\r\n          \"query_time_in_millis\": 1845896,\r\n          \"query_current\": 0,\r\n          \"fetch_total\": 17127,\r\n          \"fetch_time_in_millis\": 247028,\r\n          \"fetch_current\": 0,\r\n          \"scroll_total\": 0,\r\n          \"scroll_time_in_millis\": 0,\r\n          \"scroll_current\": 0,\r\n          \"suggest_total\": 0,\r\n          \"suggest_time_in_millis\": 0,\r\n          \"suggest_current\": 0\r\n        },\r\n        \"merges\": {\r\n          \"current\": 0,\r\n          \"current_docs\": 0,\r\n          \"current_size_in_bytes\": 0,\r\n          \"total\": 1409139,\r\n          \"total_time_in_millis\": 2886915643,\r\n          \"total_docs\": 49035135361,\r\n          \"total_size_in_bytes\": 31102491157001,\r\n          \"total_stopped_time_in_millis\": 1392859,\r\n          \"total_throttled_time_in_millis\": 1347019754,\r\n          \"total_auto_throttle_in_bytes\": 6533586445\r\n        },\r\n        \"refresh\": {\r\n          \"total\": 1150880,\r\n          \"total_time_in_millis\": 104212382,\r\n          \"listeners\": 0\r\n        },\r\n        \"flush\": {\r\n          \"total\": 4870,\r\n          \"periodic\": 3896,\r\n          \"total_time_in_millis\": 3353823\r\n        },\r\n        \"warmer\": {\r\n          \"current\": 0,\r\n          \"total\": 1145688,\r\n          \"total_time_in_millis\": 32127\r\n        },\r\n        \"query_cache\": {\r\n          \"memory_size_in_bytes\": 1508601756,\r\n          \"total_count\": 10708084,\r\n          \"hit_count\": 179335,\r\n          \"miss_count\": 10528749,\r\n          \"cache_size\": 8415,\r\n          \"cache_count\": 15144,\r\n          \"evictions\": 6729\r\n        },\r\n        \"fielddata\": {\r\n          \"memory_size_in_bytes\": 548968,\r\n          \"evictions\": 0\r\n        },\r\n        \"completion\": {\r\n          \"size_in_bytes\": 0\r\n        },\r\n        \"segments\": {\r\n          \"count\": 4429,\r\n          \"memory_in_bytes\": 18519594250,\r\n          \"terms_memory_in_bytes\": 17781776647,\r\n          \"stored_fields_memory_in_bytes\": 522397080,\r\n          \"term_vectors_memory_in_bytes\": 0,\r\n          \"norms_memory_in_bytes\": 1163328,\r\n          \"points_memory_in_bytes\": 212888975,\r\n          \"doc_values_memory_in_bytes\": 1368220,\r\n          \"index_writer_memory_in_bytes\": 0,\r\n          \"version_map_memory_in_bytes\": 0,\r\n          \"fixed_bit_set_memory_in_bytes\": 0,\r\n          \"max_unsafe_auto_id_timestamp\": 1534460344075,\r\n          \"file_sizes\": {}\r\n        },\r\n        \"translog\": {\r\n          \"operations\": 532470023,\r\n          \"size_in_bytes\": 400610878412,\r\n          \"uncommitted_operations\": 0,\r\n          \"uncommitted_size_in_bytes\": 6710,\r\n          \"earliest_last_modified_age\": 0\r\n        },\r\n        \"request_cache\": {\r\n          \"memory_size_in_bytes\": 107235,\r\n          \"evictions\": 0,\r\n          \"hit_count\": 0,\r\n          \"miss_count\": 363\r\n        },\r\n        \"recovery\": {\r\n          \"current_as_source\": 13,\r\n          \"current_as_target\": 0,\r\n          \"throttle_time_in_millis\": 199\r\n        }\r\n      }\r\n\r\nAnd the shard in question:\r\n\r\n```        \"24\": [\r\n          {\r\n            \"routing\": {\r\n              \"state\": \"STARTED\",\r\n              \"primary\": true,\r\n              \"node\": \"Z2zhHgzsRduWQh5TAgXYOA\",\r\n              \"relocating_node\": null\r\n            },\r\n            \"docs\": {\r\n              \"count\": 104377292,\r\n              \"deleted\": 0\r\n            },\r\n            \"store\": {\r\n              \"size_in_bytes\": 55763854612\r\n            },\r\n            \"indexing\": {\r\n              \"index_total\": 102655515,\r\n              \"index_time_in_millis\": 28984607,\r\n              \"index_current\": 0,\r\n              \"index_failed\": 0,\r\n              \"delete_total\": 0,\r\n              \"delete_time_in_millis\": 0,\r\n              \"delete_current\": 0,\r\n              \"noop_update_total\": 0,\r\n              \"is_throttled\": false,\r\n              \"throttle_time_in_millis\": 0\r\n            },\r\n            \"get\": {\r\n              \"total\": 0,\r\n              \"time_in_millis\": 0,\r\n              \"exists_total\": 0,\r\n              \"exists_time_in_millis\": 0,\r\n              \"missing_total\": 0,\r\n              \"missing_time_in_millis\": 0,\r\n              \"current\": 0\r\n            },\r\n            \"search\": {\r\n              \"open_contexts\": 0,\r\n              \"query_total\": 462,\r\n              \"query_time_in_millis\": 22043,\r\n              \"query_current\": 0,\r\n              \"fetch_total\": 111,\r\n              \"fetch_time_in_millis\": 2056,\r\n              \"fetch_current\": 0,\r\n              \"scroll_total\": 0,\r\n              \"scroll_time_in_millis\": 0,\r\n              \"scroll_current\": 0,\r\n              \"suggest_total\": 0,\r\n              \"suggest_time_in_millis\": 0,\r\n              \"suggest_current\": 0\r\n            },\r\n            \"merges\": {\r\n              \"current\": 0,\r\n              \"current_docs\": 0,\r\n              \"current_size_in_bytes\": 0,\r\n              \"total\": 12166,\r\n              \"total_time_in_millis\": 24614271,\r\n              \"total_docs\": 408012497,\r\n              \"total_size_in_bytes\": 259381876235,\r\n              \"total_stopped_time_in_millis\": 1129,\r\n              \"total_throttled_time_in_millis\": 12163358,\r\n              \"total_auto_throttle_in_bytes\": 47623853\r\n            },\r\n            \"refresh\": {\r\n              \"total\": 9979,\r\n              \"total_time_in_millis\": 879001,\r\n              \"listeners\": 0\r\n            },\r\n            \"flush\": {\r\n              \"total\": 41,\r\n              \"periodic\": 34,\r\n              \"total_time_in_millis\": 23972\r\n            },\r\n            \"warmer\": {\r\n              \"current\": 0,\r\n              \"total\": 9937,\r\n              \"total_time_in_millis\": 318\r\n            },\r\n            \"query_cache\": {\r\n              \"memory_size_in_bytes\": 11974438,\r\n              \"total_count\": 126229,\r\n              \"hit_count\": 1274,\r\n              \"miss_count\": 124955,\r\n              \"cache_size\": 174,\r\n              \"cache_count\": 177,\r\n              \"evictions\": 3\r\n            },\r\n            \"fielddata\": {\r\n              \"memory_size_in_bytes\": 0,\r\n              \"evictions\": 0\r\n            },\r\n            \"completion\": {\r\n              \"size_in_bytes\": 0\r\n            },\r\n            \"segments\": {\r\n              \"count\": 40,\r\n              \"memory_in_bytes\": 153351228,\r\n              \"terms_memory_in_bytes\": 147301823,\r\n              \"stored_fields_memory_in_bytes\": 4282400,\r\n              \"term_vectors_memory_in_bytes\": 0,\r\n              \"norms_memory_in_bytes\": 10560,\r\n              \"points_memory_in_bytes\": 1747621,\r\n              \"doc_values_memory_in_bytes\": 8824,\r\n              \"index_writer_memory_in_bytes\": 0,\r\n              \"version_map_memory_in_bytes\": 0,\r\n              \"fixed_bit_set_memory_in_bytes\": 0,\r\n              \"max_unsafe_auto_id_timestamp\": 1534460340053,\r\n              \"file_sizes\": {}\r\n            },\r\n            \"translog\": {\r\n              \"operations\": 36053875,\r\n              \"size_in_bytes\": 27082560372,\r\n              \"uncommitted_operations\": 0,\r\n              \"uncommitted_size_in_bytes\": 55,\r\n              \"earliest_last_modified_age\": 7618269\r\n            },\r\n            \"request_cache\": {\r\n              \"memory_size_in_bytes\": 0,\r\n              \"evictions\": 0,\r\n              \"hit_count\": 0,\r\n              \"miss_count\": 1\r\n            },\r\n            \"recovery\": {\r\n              \"current_as_source\": 1,\r\n              \"current_as_target\": 0,\r\n              \"throttle_time_in_millis\": 0\r\n            },\r\n            \"commit\": {\r\n              \"id\": \"NgHyOieMnnjOv1Hw6PFoGw==\",\r\n              \"generation\": 48,\r\n              \"user_data\": {\r\n                \"local_checkpoint\": \"104377442\",\r\n                \"max_unsafe_auto_id_timestamp\": \"1534460340053\",\r\n                \"translog_uuid\": \"Kiaim6eQSdSO9cPzGJYMbQ\",\r\n                \"history_uuid\": \"K7_gT4mnSeGZ0R3o4irRPw\",\r\n                \"sync_id\": \"zSY1kxZKTA69fa3lY5mIbQ\",\r\n                \"translog_generation\": \"1170\",\r\n                \"max_seq_no\": \"104377442\"\r\n              },\r\n              \"num_docs\": 104377292\r\n            },\r\n            \"seq_no\": {\r\n              \"max_seq_no\": 104377442,\r\n              \"local_checkpoint\": 104377442,\r\n              \"global_checkpoint\": 104377442\r\n            },\r\n            \"shard_path\": {\r\n              \"state_path\": \"/storage/elasticsearch/nodes/0\",\r\n              \"data_path\": \"/storage/elasticsearch/nodes/0\",\r\n              \"is_custom_data_path\": false\r\n            }\r\n          },\r\n          {\r\n            \"routing\": {\r\n              \"state\": \"STARTED\",\r\n              \"primary\": false,\r\n              \"node\": \"IytAnZXSRe-Np7X6frSnRg\",\r\n              \"relocating_node\": null\r\n            },\r\n            \"docs\": {\r\n              \"count\": 104377292,\r\n              \"deleted\": 0\r\n            },\r\n            \"store\": {\r\n              \"size_in_bytes\": 55808763196\r\n            },\r\n            \"indexing\": {\r\n              \"index_total\": 104378207,\r\n              \"index_time_in_millis\": 29069902,\r\n              \"index_current\": 0,\r\n              \"index_failed\": 0,\r\n              \"delete_total\": 0,\r\n              \"delete_time_in_millis\": 0,\r\n              \"delete_current\": 0,\r\n              \"noop_update_total\": 0,\r\n              \"is_throttled\": false,\r\n              \"throttle_time_in_millis\": 0\r\n            },\r\n            \"get\": {\r\n              \"total\": 0,\r\n              \"time_in_millis\": 0,\r\n              \"exists_total\": 0,\r\n              \"exists_time_in_millis\": 0,\r\n              \"missing_total\": 0,\r\n              \"missing_time_in_millis\": 0,\r\n              \"current\": 0\r\n            },\r\n            \"search\": {\r\n              \"open_contexts\": 0,\r\n              \"query_total\": 509,\r\n              \"query_time_in_millis\": 14858,\r\n              \"query_current\": 0,\r\n              \"fetch_total\": 138,\r\n              \"fetch_time_in_millis\": 2207,\r\n              \"fetch_current\": 0,\r\n              \"scroll_total\": 0,\r\n              \"scroll_time_in_millis\": 0,\r\n              \"scroll_current\": 0,\r\n              \"suggest_total\": 0,\r\n              \"suggest_time_in_millis\": 0,\r\n              \"suggest_current\": 0\r\n            },\r\n            \"merges\": {\r\n              \"current\": 0,\r\n              \"current_docs\": 0,\r\n              \"current_size_in_bytes\": 0,\r\n              \"total\": 12982,\r\n              \"total_time_in_millis\": 25564819,\r\n              \"total_docs\": 419646085,\r\n              \"total_size_in_bytes\": 266669436195,\r\n              \"total_stopped_time_in_millis\": 18403,\r\n              \"total_throttled_time_in_millis\": 12422632,\r\n              \"total_auto_throttle_in_bytes\": 43655199\r\n            },\r\n            \"refresh\": {\r\n              \"total\": 10690,\r\n              \"total_time_in_millis\": 898581,\r\n              \"listeners\": 0\r\n            },\r\n            \"flush\": {\r\n              \"total\": 43,\r\n              \"periodic\": 34,\r\n              \"total_time_in_millis\": 22349\r\n            },\r\n            \"warmer\": {\r\n              \"current\": 0,\r\n              \"total\": 10643,\r\n              \"total_time_in_millis\": 274\r\n            },\r\n            \"query_cache\": {\r\n              \"memory_size_in_bytes\": 12160499,\r\n              \"total_count\": 89348,\r\n              \"hit_count\": 1488,\r\n              \"miss_count\": 87860,\r\n              \"cache_size\": 100,\r\n              \"cache_count\": 105,\r\n              \"evictions\": 5\r\n            },\r\n            \"fielddata\": {\r\n              \"memory_size_in_bytes\": 6800,\r\n              \"evictions\": 0\r\n            },\r\n            \"completion\": {\r\n              \"size_in_bytes\": 0\r\n            },\r\n            \"segments\": {\r\n              \"count\": 38,\r\n              \"memory_in_bytes\": 152663986,\r\n              \"terms_memory_in_bytes\": 146617163,\r\n              \"stored_fields_memory_in_bytes\": 4275584,\r\n              \"term_vectors_memory_in_bytes\": 0,\r\n              \"norms_memory_in_bytes\": 10048,\r\n              \"points_memory_in_bytes\": 1747951,\r\n              \"doc_values_memory_in_bytes\": 13240,\r\n              \"index_writer_memory_in_bytes\": 0,\r\n              \"version_map_memory_in_bytes\": 0,\r\n              \"fixed_bit_set_memory_in_bytes\": 0,\r\n              \"max_unsafe_auto_id_timestamp\": 1534460340053,\r\n              \"file_sizes\": {}\r\n            },\r\n            \"translog\": {\r\n              \"operations\": 726048,\r\n              \"size_in_bytes\": 551815741,\r\n              \"uncommitted_operations\": 0,\r\n              \"uncommitted_size_in_bytes\": 55,\r\n              \"earliest_last_modified_age\": 5854682\r\n            },\r\n            \"request_cache\": {\r\n              \"memory_size_in_bytes\": 2383,\r\n              \"evictions\": 0,\r\n              \"hit_count\": 0,\r\n              \"miss_count\": 6\r\n            },\r\n            \"recovery\": {\r\n              \"current_as_source\": 0,\r\n              \"current_as_target\": 0,\r\n              \"throttle_time_in_millis\": 0\r\n            },\r\n            \"commit\": {\r\n              \"id\": \"X9ulEr6/ReWO/YHF6G1skA==\",\r\n              \"generation\": 47,\r\n              \"user_data\": {\r\n                \"local_checkpoint\": \"104377442\",\r\n                \"max_unsafe_auto_id_timestamp\": \"1534460340053\",\r\n                \"translog_uuid\": \"VkIAw8zxRXuHG40LnxDcyw\",\r\n                \"history_uuid\": \"K7_gT4mnSeGZ0R3o4irRPw\",\r\n                \"sync_id\": \"zSY1kxZKTA69fa3lY5mIbQ\",\r\n                \"translog_generation\": \"1172\",\r\n                \"max_seq_no\": \"104377442\"\r\n              },\r\n              \"num_docs\": 104377292\r\n            },\r\n            \"seq_no\": {\r\n              \"max_seq_no\": 104377442,\r\n              \"local_checkpoint\": 104377442,\r\n              \"global_checkpoint\": 104377442\r\n            },\r\n            \"shard_path\": {\r\n              \"state_path\": \"/storage/elasticsearch/nodes/0\",\r\n              \"data_path\": \"/storage/elasticsearch/nodes/0\",\r\n              \"is_custom_data_path\": false\r\n            }\r\n          }\r\n        ],","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413737846","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413737846","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413737846,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzczNzg0Ng==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T02:17:15Z","updated_at":"2018-08-17T02:17:49Z","author_association":"MEMBER","body":"@danielkasen Thanks for the stats.\r\n\r\n```\r\n\"translog\": {\r\n \t\"operations\": 36053875,\r\n        \"size_in_bytes\": 27082560372,\r\n        \"uncommitted_operations\": 0,\r\n        \"uncommitted_size_in_bytes\": 55,\r\n        \"earliest_last_modified_age\": 7618269\r\n}\r\n```\r\n\r\nThe primary shard is keeping 25GB translog. Did you change the [translog retention settings](https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-translog.html#_translog_settings) (index.translog.retention.size or index.translog.retention.age)?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413740462","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413740462","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413740462,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzc0MDQ2Mg==","user":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T02:35:30Z","updated_at":"2018-08-17T02:35:30Z","author_association":"NONE","body":"yes, we have a rather large throughput on the index and it can generate much more then the default 512mb. Otherwise the shard has to completely rebuild when it the node comes back online. I'm ok with having this extra space during this time, but the logs get copied over slowly. Here is the index setting.\r\n\r\n```        \"translog\": {\r\n          \"flush_threshold_size\": \"2048mb\",\r\n          \"sync_interval\": \"5s\",\r\n          \"retention\": {\r\n            \"size\": \"50gb\",\r\n            \"age\": \"30m\"\r\n          },\r\n          \"durability\": \"async\"","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413763261","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413763261","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413763261,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzc2MzI2MQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T05:41:14Z","updated_at":"2018-08-17T05:41:14Z","author_association":"CONTRIBUTOR","body":"Could we see the output of \r\n\r\n```\r\nGET /_nodes/_local/hot_threads?threads=1000&ignore_idle_threads=false\r\n```\r\n\r\non the source node, during the translog phase of such a recovery?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413857093","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413857093","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413857093,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzg1NzA5Mw==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T12:58:17Z","updated_at":"2018-08-17T12:58:17Z","author_association":"MEMBER","body":"@danielkasen The problem is that your translog retention is too high: `\"retention\": { \"size\": \"50gb\"}`.  The recovery process has to \"replay\" 30 million operations for the shard[24]. Replaying operations is much more than just copying over the wire.\r\n\r\n> we have a rather large throughput on the index and it can generate much more then the default 512mb. Otherwise the shard has to completely rebuild when it the node comes back online\r\n\r\nThis change is not necessary. If a node comeback and the primary does not have the required translog for the sequence-based recovery, we fall back to the file-based recovery. Note that the shard[24] is executing a file-based recovery even with this setting.\r\n\r\nI would recommend reducing the retention setting. I am closing this as we use Github for bug reports and feature requests. Feel free to continue the discussion at [https://discuss.elastic.co](https://discuss.elastic.co). Thank you!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413920852","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413920852","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413920852,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzkyMDg1Mg==","user":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T16:34:13Z","updated_at":"2018-08-17T16:34:13Z","author_association":"NONE","body":"Sure, but doesn't this then require a completely new copy of the shard to be transferred and then the new translogs need to catch up anyway? With a 50GB shard I usually have to wait 40+ minutes for the recovery to happen and am trying to figure out a way to speed this up by just needing to apply the translogs (figured that was the point of them).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413921058","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-413921058","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":413921058,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzkyMTA1OA==","user":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T16:35:08Z","updated_at":"2018-08-17T16:35:08Z","author_association":"NONE","body":"This also doesn't explain why the translog copy process is so slow. Feels like the transport layer could be copying them in parallel.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/416800431","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-416800431","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":416800431,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNjgwMDQzMQ==","user":{"login":"thomas-tomlinson","id":14020002,"node_id":"MDQ6VXNlcjE0MDIwMDAy","avatar_url":"https://avatars3.githubusercontent.com/u/14020002?v=4","gravatar_id":"","url":"https://api.github.com/users/thomas-tomlinson","html_url":"https://github.com/thomas-tomlinson","followers_url":"https://api.github.com/users/thomas-tomlinson/followers","following_url":"https://api.github.com/users/thomas-tomlinson/following{/other_user}","gists_url":"https://api.github.com/users/thomas-tomlinson/gists{/gist_id}","starred_url":"https://api.github.com/users/thomas-tomlinson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomas-tomlinson/subscriptions","organizations_url":"https://api.github.com/users/thomas-tomlinson/orgs","repos_url":"https://api.github.com/users/thomas-tomlinson/repos","events_url":"https://api.github.com/users/thomas-tomlinson/events{/privacy}","received_events_url":"https://api.github.com/users/thomas-tomlinson/received_events","type":"User","site_admin":false},"created_at":"2018-08-29T02:15:00Z","updated_at":"2018-08-29T02:15:00Z","author_association":"NONE","body":"I ran into a similar though put issue (assuming that your 8Mbs is actually 8MB/s) on recovery no matter what I set the max_bytes_per_sec (including -1).  Turns out I had the transport.tcp.compress set to true which was the throttle.  Changing that to false made an instant difference and now the bottleneck is either the max_bytes_per_sec setting or the underlying hardware infrastructure.   ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/416863808","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-416863808","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":416863808,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNjg2MzgwOA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-08-29T08:06:45Z","updated_at":"2018-08-29T08:06:45Z","author_association":"CONTRIBUTOR","body":"I think this warrants some further investigation, although I will reiterate @dnhatn's recommendation to reset the translog retention settings back to their defaults. Ops-based recoveries are quicker because they can sometimes avoid reading and transmitting too much data rather than because they are inherently faster: in fact replaying operations from the translog is quite a bit more expensive than simply copying the segment files over, so there's definitely a point at which a replica has fallen so far behind that it's cheaper to rebuild it from scratch. Replaying the translog is much more than a \"copy process\". In addition, retaining such a large translog violates some assumptions about things like how far out of order its contents can be, and this affects how things are tuned internally.\r\n\r\nPlease could you re-run these experiments with default translog retention settings and report back? If this is in a test cluster then you could also set `logger.org.elasticsearch.indices.recovery: TRACE` so you can see how long some of the internal steps are taking.\r\n\r\n@thomas-tomlinson I'm not convinced this is related to `transport.tcp.compress` (this option is off by default and not shown in the settings in the OP) but it is worth noting that throttling takes place before compression.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/422185901","html_url":"https://github.com/elastic/elasticsearch/issues/32924#issuecomment-422185901","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32924","id":422185901,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMjE4NTkwMQ==","user":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"created_at":"2018-09-17T21:59:34Z","updated_at":"2018-09-17T21:59:34Z","author_association":"NONE","body":"So, sorry I missed these responses. But I would like to point out I have tcp compression on. It's not a dynamic setting so it's in the elasticsearch.yml file. ","performed_via_github_app":null}]
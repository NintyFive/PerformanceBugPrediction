{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/19290","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19290/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19290/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19290/events","html_url":"https://github.com/elastic/elasticsearch/issues/19290","id":164179300,"node_id":"MDU6SXNzdWUxNjQxNzkzMDA=","number":19290,"title":"Low performance of source filtering","user":{"login":"luisobo","id":825073,"node_id":"MDQ6VXNlcjgyNTA3Mw==","avatar_url":"https://avatars1.githubusercontent.com/u/825073?v=4","gravatar_id":"","url":"https://api.github.com/users/luisobo","html_url":"https://github.com/luisobo","followers_url":"https://api.github.com/users/luisobo/followers","following_url":"https://api.github.com/users/luisobo/following{/other_user}","gists_url":"https://api.github.com/users/luisobo/gists{/gist_id}","starred_url":"https://api.github.com/users/luisobo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luisobo/subscriptions","organizations_url":"https://api.github.com/users/luisobo/orgs","repos_url":"https://api.github.com/users/luisobo/repos","events_url":"https://api.github.com/users/luisobo/events{/privacy}","received_events_url":"https://api.github.com/users/luisobo/received_events","type":"User","site_admin":false},"labels":[{"id":152517143,"node_id":"MDU6TGFiZWwxNTI1MTcxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/REST%20API","name":":Core/Infra/REST API","color":"0e8a16","default":false,"description":"REST infrastructure and utilities"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2016-07-06T21:31:46Z","updated_at":"2017-03-31T13:41:42Z","closed_at":"2017-03-31T13:41:42Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**:\n2.3.3 on Elastic cloud\n\n**JVM version**:\nNot sure\n\n**OS version**:\nNot sure\n\n**Description of the problem including expected versus actual behavior**:\nWhen doing a query and providing a list of fields in `_source`, the filtering of those fields takes a considerable amount of time.\n\n**Steps to reproduce**:\n1. Given an index with at least a thousand documents\n2. Make a query that matches at least a thousand documents and set `size: 1000`\n3. Provide a list of fields  in the `_source` request param\n\nThis request takes a couple of seconds (specifically, the `took` field in the response body).\n\nIn contrast, when you set `_source: true` so that it returns all fields of the source, the request takes 100ms (but the transfer takes longer if each whole document is big)\n\nIt seems to be the case that most of the time goes into filtering the fields of every source object, and not reading the objects. If that is the case, I think there should be room for improvement in reformatting 1000 documents in less time.\n\nI wouldn't mind making this my first contribution to ES. I'd propose to first, make a pull request to highlight source filtering in the profiler as I don't think that is measured. Make a second pull request that to improve the performance of source filtering. \n\nIf this seems reasonable, I'd love to hear your thoughts as well as any pointers,\n\nThanks\n","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
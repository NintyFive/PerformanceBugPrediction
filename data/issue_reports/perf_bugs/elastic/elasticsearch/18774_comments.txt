[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224656141","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-224656141","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":224656141,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDY1NjE0MQ==","user":{"login":"gpstathis","id":365914,"node_id":"MDQ6VXNlcjM2NTkxNA==","avatar_url":"https://avatars0.githubusercontent.com/u/365914?v=4","gravatar_id":"","url":"https://api.github.com/users/gpstathis","html_url":"https://github.com/gpstathis","followers_url":"https://api.github.com/users/gpstathis/followers","following_url":"https://api.github.com/users/gpstathis/following{/other_user}","gists_url":"https://api.github.com/users/gpstathis/gists{/gist_id}","starred_url":"https://api.github.com/users/gpstathis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpstathis/subscriptions","organizations_url":"https://api.github.com/users/gpstathis/orgs","repos_url":"https://api.github.com/users/gpstathis/repos","events_url":"https://api.github.com/users/gpstathis/events{/privacy}","received_events_url":"https://api.github.com/users/gpstathis/received_events","type":"User","site_admin":false},"created_at":"2016-06-08T16:55:43Z","updated_at":"2016-06-08T19:55:12Z","author_association":"CONTRIBUTOR","body":"Here is the profiler output:\n\nhttps://gist.github.com/gpstathis/d284e2ad8b8ac3830901549c558ce36b\n\nBecause of #18693, take the numbers with a grain of salt but one can still see that the majority of the time is spent on iterating over the matches which is validated when reducing the date range in the query: the shorter the date range the faster the response times.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224671698","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-224671698","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":224671698,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDY3MTY5OA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-06-08T17:45:22Z","updated_at":"2016-06-08T17:45:22Z","author_association":"CONTRIBUTOR","body":"I don't know much about GlobalOrdinals, but it looks like they come up in this issue. Does anyone who knows more want to take a look?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224797964","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-224797964","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":224797964,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDc5Nzk2NA==","user":{"login":"gpstathis","id":365914,"node_id":"MDQ6VXNlcjM2NTkxNA==","avatar_url":"https://avatars0.githubusercontent.com/u/365914?v=4","gravatar_id":"","url":"https://api.github.com/users/gpstathis","html_url":"https://github.com/gpstathis","followers_url":"https://api.github.com/users/gpstathis/followers","following_url":"https://api.github.com/users/gpstathis/following{/other_user}","gists_url":"https://api.github.com/users/gpstathis/gists{/gist_id}","starred_url":"https://api.github.com/users/gpstathis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpstathis/subscriptions","organizations_url":"https://api.github.com/users/gpstathis/orgs","repos_url":"https://api.github.com/users/gpstathis/repos","events_url":"https://api.github.com/users/gpstathis/events{/privacy}","received_events_url":"https://api.github.com/users/gpstathis/received_events","type":"User","site_admin":false},"created_at":"2016-06-09T04:35:34Z","updated_at":"2016-06-09T13:42:57Z","author_association":"CONTRIBUTOR","body":"Thanks @nik9000. I don't know if this is only for Aggregations, but according to https://www.elastic.co/guide/en/elasticsearch/guide/current/preload-fielddata.html#global-ordinals:\n\n> Once global ordinals have been rebuilt, they will be reused until the segments in the index change: after a refresh, a flush, or a merge\n\nSo if we update the index frequently and keep merging, we don't really give global ordinals the chance to build up. In theory then, if we extend `refresh_interval` we should be able to see the benefits from global ordinals. I tested this by setting `refresh_interval` to `120s`â€”there was no difference in the response times.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224830379","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-224830379","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":224830379,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDgzMDM3OQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-06-09T08:23:15Z","updated_at":"2016-06-09T08:23:15Z","author_association":"CONTRIBUTOR","body":"I could be wrong, but since documents are only allowed to have a single parent, you should be able to run this query with a single join instead of 3.\n\n``` javascript\n{\n  \"from\": 0,\n  \"size\": 25,\n  \"query\": {\n    \"constant_score\": {\n      \"filter\": {\n        \"bool\": {\n          \"filter\": [\n            {\n              \"has_parent\": {\n                \"query\": {\n                  \"bool\": {\n                    \"filter\": [\n                      {\n                        \"terms\": {\n                          \"itype\": [\n                            \"person\"\n                          ]\n                        }\n                      },\n                      {\n                        \"term\": {\n                          \"tags\": \"bf0c5985e9644cf3:infs/acct/\"\n                        }\n                      },\n                      {\n                        \"term\": {\n                          \"tags\": \"bf0c5985e9644cf3:infs/proj/21694/\"\n                        }\n                      }\n                    ]\n                  }\n                },\n                \"parent_type\": \"influencer\"\n              }\n            },\n            {\n              \"range\": {\n                \"publishedDate\": {\n                  \"from\": \"2015-04-29T00:00:00-0400\",\n                  \"to\": \"2016-06-02T23:59:59-0400\",\n                  \"include_lower\": true,\n                  \"include_upper\": true\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  },\n  \"fields\": \"*\",\n  \"sort\": [\n    {\n      \"publishedDate\": {\n        \"order\": \"desc\"\n      }\n    }\n  ]\n}\n```\n\nGiven that the hot threads suggest that the bottleneck is the join, this should help on both versions and might also help reduce the gap. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224899193","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-224899193","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":224899193,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDg5OTE5Mw==","user":{"login":"gpstathis","id":365914,"node_id":"MDQ6VXNlcjM2NTkxNA==","avatar_url":"https://avatars0.githubusercontent.com/u/365914?v=4","gravatar_id":"","url":"https://api.github.com/users/gpstathis","html_url":"https://github.com/gpstathis","followers_url":"https://api.github.com/users/gpstathis/followers","following_url":"https://api.github.com/users/gpstathis/following{/other_user}","gists_url":"https://api.github.com/users/gpstathis/gists{/gist_id}","starred_url":"https://api.github.com/users/gpstathis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpstathis/subscriptions","organizations_url":"https://api.github.com/users/gpstathis/orgs","repos_url":"https://api.github.com/users/gpstathis/repos","events_url":"https://api.github.com/users/gpstathis/events{/privacy}","received_events_url":"https://api.github.com/users/gpstathis/received_events","type":"User","site_admin":false},"created_at":"2016-06-09T13:46:07Z","updated_at":"2016-06-09T13:46:07Z","author_association":"CONTRIBUTOR","body":"Thanks @jpountz . These queries are dynamically constructed so it looks like we need to go back and take closer look at the code that does the joins on `_parent`.\n\nUnfortunately, I tested it, and while rewriting it does shave about 1 second from the 13 seconds it used to take on 2.3.3, it's still a 2x performance degradation from 1.4.2. \n\nHere are the hot threads while running it: https://gist.github.com/gpstathis/1b508d08e4e612cf9dd0f0224bfabfcd\n\nSo there is still a very large gap that we are striving to explain here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224908003","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-224908003","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":224908003,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDkwODAwMw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-06-09T14:15:58Z","updated_at":"2016-06-09T14:15:58Z","author_association":"CONTRIBUTOR","body":"I agree the fact that it is still more than 2x slower than 1.x is puzzling. Can you tell us:\n- how many parents and children documents the index has\n- how many documents match each individual query (the range, the has_parent, the bool under the has_parent, and each query under the bool)\n- are there parts of the query that are often the same?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224968813","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-224968813","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":224968813,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDk2ODgxMw==","user":{"login":"gpstathis","id":365914,"node_id":"MDQ6VXNlcjM2NTkxNA==","avatar_url":"https://avatars0.githubusercontent.com/u/365914?v=4","gravatar_id":"","url":"https://api.github.com/users/gpstathis","html_url":"https://github.com/gpstathis","followers_url":"https://api.github.com/users/gpstathis/followers","following_url":"https://api.github.com/users/gpstathis/following{/other_user}","gists_url":"https://api.github.com/users/gpstathis/gists{/gist_id}","starred_url":"https://api.github.com/users/gpstathis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpstathis/subscriptions","organizations_url":"https://api.github.com/users/gpstathis/orgs","repos_url":"https://api.github.com/users/gpstathis/repos","events_url":"https://api.github.com/users/gpstathis/events{/privacy}","received_events_url":"https://api.github.com/users/gpstathis/received_events","type":"User","site_admin":false},"created_at":"2016-06-09T17:33:35Z","updated_at":"2016-06-09T17:33:35Z","author_association":"CONTRIBUTOR","body":"@jpountz sent the numbers to your Gmail address.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/225029215","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-225029215","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":225029215,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNTAyOTIxNQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-06-09T21:15:51Z","updated_at":"2016-06-09T21:15:51Z","author_association":"CONTRIBUTOR","body":"Thanks, these numbers will help me reproduce the problem locally. Could you also give again the output of the profiler, but with the new query this time?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/225032893","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-225032893","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":225032893,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNTAzMjg5Mw==","user":{"login":"gpstathis","id":365914,"node_id":"MDQ6VXNlcjM2NTkxNA==","avatar_url":"https://avatars0.githubusercontent.com/u/365914?v=4","gravatar_id":"","url":"https://api.github.com/users/gpstathis","html_url":"https://github.com/gpstathis","followers_url":"https://api.github.com/users/gpstathis/followers","following_url":"https://api.github.com/users/gpstathis/following{/other_user}","gists_url":"https://api.github.com/users/gpstathis/gists{/gist_id}","starred_url":"https://api.github.com/users/gpstathis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpstathis/subscriptions","organizations_url":"https://api.github.com/users/gpstathis/orgs","repos_url":"https://api.github.com/users/gpstathis/repos","events_url":"https://api.github.com/users/gpstathis/events{/privacy}","received_events_url":"https://api.github.com/users/gpstathis/received_events","type":"User","site_admin":false},"created_at":"2016-06-09T21:30:37Z","updated_at":"2016-06-09T21:30:37Z","author_association":"CONTRIBUTOR","body":"@jpountz here you go: https://gist.github.com/gpstathis/e2e4f3bacd9462ebfd63672a35db278a\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/225256558","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-225256558","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":225256558,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNTI1NjU1OA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-06-10T18:15:28Z","updated_at":"2016-06-10T18:15:28Z","author_association":"CONTRIBUTOR","body":"I have been digging a bit, there seem to be several factors at play, but the main one seems to me about how we run conjunctions. We used to have optimizations for very specific cases through FilteredQuery that got lost when we replaced it with BooleanQuery and switched to different bitset impls for the cache (roaring instead of plain bit sets, and FilteredQuery/BooleanFilter had optimizations for the bitset case, look for eg. `RandomAccessFilterStrategy` in the 1.x hot threads). I started working on some changes in Lucene (see https://issues.apache.org/jira/browse/LUCENE-7330 and https://issues.apache.org/jira/browse/LUCENE-7332) but they won't be available until elasticsearch 5.x.\n\nThe fact that parent/child runs on doc values rather than in-memory fielddata in 2.x probably also explains part of the performance hit, but it is unclear how much. I would expect the contribution to be less than the conjunction thing though.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/225321826","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-225321826","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":225321826,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNTMyMTgyNg==","user":{"login":"gpstathis","id":365914,"node_id":"MDQ6VXNlcjM2NTkxNA==","avatar_url":"https://avatars0.githubusercontent.com/u/365914?v=4","gravatar_id":"","url":"https://api.github.com/users/gpstathis","html_url":"https://github.com/gpstathis","followers_url":"https://api.github.com/users/gpstathis/followers","following_url":"https://api.github.com/users/gpstathis/following{/other_user}","gists_url":"https://api.github.com/users/gpstathis/gists{/gist_id}","starred_url":"https://api.github.com/users/gpstathis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpstathis/subscriptions","organizations_url":"https://api.github.com/users/gpstathis/orgs","repos_url":"https://api.github.com/users/gpstathis/repos","events_url":"https://api.github.com/users/gpstathis/events{/privacy}","received_events_url":"https://api.github.com/users/gpstathis/received_events","type":"User","site_admin":false},"created_at":"2016-06-10T23:52:58Z","updated_at":"2016-06-10T23:52:58Z","author_association":"CONTRIBUTOR","body":"Thanks for taking a look @jpountz .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226442462","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-226442462","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":226442462,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjQ0MjQ2Mg==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T10:03:10Z","updated_at":"2016-06-16T10:03:10Z","author_association":"CONTRIBUTOR","body":"I also opened https://issues.apache.org/jira/browse/LUCENE-7339, which I think also explains the slow down that you have been seeing. Even though the benchmark on the issue sees a 6% jump, this happens with a range that is _not_ cached, so it would likely be better with a cached range (which I think could be the case in your queries since you said the range should get reused).\n\nIf you don't mind I will now close this issue. Things will hopefully get better in 5.0.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226609185","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-226609185","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":226609185,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYwOTE4NQ==","user":{"login":"gpstathis","id":365914,"node_id":"MDQ6VXNlcjM2NTkxNA==","avatar_url":"https://avatars0.githubusercontent.com/u/365914?v=4","gravatar_id":"","url":"https://api.github.com/users/gpstathis","html_url":"https://github.com/gpstathis","followers_url":"https://api.github.com/users/gpstathis/followers","following_url":"https://api.github.com/users/gpstathis/following{/other_user}","gists_url":"https://api.github.com/users/gpstathis/gists{/gist_id}","starred_url":"https://api.github.com/users/gpstathis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpstathis/subscriptions","organizations_url":"https://api.github.com/users/gpstathis/orgs","repos_url":"https://api.github.com/users/gpstathis/repos","events_url":"https://api.github.com/users/gpstathis/events{/privacy}","received_events_url":"https://api.github.com/users/gpstathis/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T20:48:06Z","updated_at":"2016-06-16T20:48:06Z","author_association":"CONTRIBUTOR","body":"Thanks @jpountz . Is 5.0 the earliest version that will benefit from these patches?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226707140","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-226707140","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":226707140,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjcwNzE0MA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-06-17T08:06:43Z","updated_at":"2016-06-17T08:06:43Z","author_association":"CONTRIBUTOR","body":"I expect these changes to be in Lucene 6.2, which means they should be in elasticsearch 5.1 in the worst case, but likely in elasticsearch 5.0. However it won't be in any 2.x release.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226776893","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-226776893","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":226776893,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjc3Njg5Mw==","user":{"login":"gpstathis","id":365914,"node_id":"MDQ6VXNlcjM2NTkxNA==","avatar_url":"https://avatars0.githubusercontent.com/u/365914?v=4","gravatar_id":"","url":"https://api.github.com/users/gpstathis","html_url":"https://github.com/gpstathis","followers_url":"https://api.github.com/users/gpstathis/followers","following_url":"https://api.github.com/users/gpstathis/following{/other_user}","gists_url":"https://api.github.com/users/gpstathis/gists{/gist_id}","starred_url":"https://api.github.com/users/gpstathis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gpstathis/subscriptions","organizations_url":"https://api.github.com/users/gpstathis/orgs","repos_url":"https://api.github.com/users/gpstathis/repos","events_url":"https://api.github.com/users/gpstathis/events{/privacy}","received_events_url":"https://api.github.com/users/gpstathis/received_events","type":"User","site_admin":false},"created_at":"2016-06-17T14:02:29Z","updated_at":"2016-06-17T14:02:29Z","author_association":"CONTRIBUTOR","body":"@jpountz ok thanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/357886843","html_url":"https://github.com/elastic/elasticsearch/issues/18774#issuecomment-357886843","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18774","id":357886843,"node_id":"MDEyOklzc3VlQ29tbWVudDM1Nzg4Njg0Mw==","user":{"login":"gauravbhattpb","id":22285409,"node_id":"MDQ6VXNlcjIyMjg1NDA5","avatar_url":"https://avatars1.githubusercontent.com/u/22285409?v=4","gravatar_id":"","url":"https://api.github.com/users/gauravbhattpb","html_url":"https://github.com/gauravbhattpb","followers_url":"https://api.github.com/users/gauravbhattpb/followers","following_url":"https://api.github.com/users/gauravbhattpb/following{/other_user}","gists_url":"https://api.github.com/users/gauravbhattpb/gists{/gist_id}","starred_url":"https://api.github.com/users/gauravbhattpb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gauravbhattpb/subscriptions","organizations_url":"https://api.github.com/users/gauravbhattpb/orgs","repos_url":"https://api.github.com/users/gauravbhattpb/repos","events_url":"https://api.github.com/users/gauravbhattpb/events{/privacy}","received_events_url":"https://api.github.com/users/gauravbhattpb/received_events","type":"User","site_admin":false},"created_at":"2018-01-16T08:27:21Z","updated_at":"2018-01-16T08:28:03Z","author_association":"NONE","body":"We were in same situation after an upgrade from 1.4.4 to 2.4.1 where we saw search performance degrade. In our case however the issue was with the source filtering (setFetchSource with specific list of fields) call which was taking time.","performed_via_github_app":null}]
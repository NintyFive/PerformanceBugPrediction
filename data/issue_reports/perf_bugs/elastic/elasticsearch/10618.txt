{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/10618","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10618/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10618/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10618/events","html_url":"https://github.com/elastic/elasticsearch/issues/10618","id":68744211,"node_id":"MDU6SXNzdWU2ODc0NDIxMQ==","number":10618,"title":"Slow Search Requests For A Couple Seconds Every Minute","user":{"login":"darylrobbins","id":2270905,"node_id":"MDQ6VXNlcjIyNzA5MDU=","avatar_url":"https://avatars1.githubusercontent.com/u/2270905?v=4","gravatar_id":"","url":"https://api.github.com/users/darylrobbins","html_url":"https://github.com/darylrobbins","followers_url":"https://api.github.com/users/darylrobbins/followers","following_url":"https://api.github.com/users/darylrobbins/following{/other_user}","gists_url":"https://api.github.com/users/darylrobbins/gists{/gist_id}","starred_url":"https://api.github.com/users/darylrobbins/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/darylrobbins/subscriptions","organizations_url":"https://api.github.com/users/darylrobbins/orgs","repos_url":"https://api.github.com/users/darylrobbins/repos","events_url":"https://api.github.com/users/darylrobbins/events{/privacy}","received_events_url":"https://api.github.com/users/darylrobbins/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-04-15T17:45:10Z","updated_at":"2015-04-15T23:45:26Z","closed_at":"2015-04-15T23:45:25Z","author_association":"NONE","active_lock_reason":null,"body":"Running ElasticSearch 1.5.1 under Java 7 and tried Java 8 as well.\n\nI am seeing slow search requests (~2 seconds) at the exact same second every minute across all my Java/Transport Client nodes. I have ruled out GC and can't find any other background threads running at the time. There is also no other process affecting performance on the machines.\n\nHere is our environment setup. We are running on AWS. All nodes are located in the same region, so latency between nodes is not an issue.\n\n![es setup](https://cloud.githubusercontent.com/assets/2270905/7165176/fe510ef0-e373-11e4-93d2-66d9ded64681.png)\n\nThe load generators are generating consistent light to moderate load on the API servers. The exact second that the slow down occurs will differ between runs but the results will always be consistent across all client nodes for the run.\n\nIt seems like some sort of heartbeat or timeout is being hit. I don't see anything in the slowlog at the times of the slow down. However, entries do get written when the cluster is first starting up and everything has been cached, so that at least confirms that it's working.\n\nThe exact number of data nodes may differ by run but there are always at least 2.\n\nThe API nodes are completely independent except for communicating with the ES cluster via the transport client (port 9300).\n\nHere is an example run:\n\n![screenshot 2015-04-15 13 15 47](https://cloud.githubusercontent.com/assets/2270905/7164921/ce99e2c4-e371-11e4-80fd-7ac0e953e249.png)\n\nThe load being generated seems to have no impact on the issue. It happens as consistently under light load vs heavier load. None of the servers was over 80% CPU for any of these tests and many were run under 40 - 60% CPU.\n\nThere are times when no nodes or a subset of nodes are affected in a given minute but they are all affected more often than not. And they normally resume seeing the same performance slowdown at the same second within a minute or two.\n\nAny ideas on how to troubleshoot this issue further would be greatly appreciated. Thanks very much!\n","closed_by":{"login":"darylrobbins","id":2270905,"node_id":"MDQ6VXNlcjIyNzA5MDU=","avatar_url":"https://avatars1.githubusercontent.com/u/2270905?v=4","gravatar_id":"","url":"https://api.github.com/users/darylrobbins","html_url":"https://github.com/darylrobbins","followers_url":"https://api.github.com/users/darylrobbins/followers","following_url":"https://api.github.com/users/darylrobbins/following{/other_user}","gists_url":"https://api.github.com/users/darylrobbins/gists{/gist_id}","starred_url":"https://api.github.com/users/darylrobbins/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/darylrobbins/subscriptions","organizations_url":"https://api.github.com/users/darylrobbins/orgs","repos_url":"https://api.github.com/users/darylrobbins/repos","events_url":"https://api.github.com/users/darylrobbins/events{/privacy}","received_events_url":"https://api.github.com/users/darylrobbins/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
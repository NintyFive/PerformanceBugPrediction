[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/214843650","html_url":"https://github.com/elastic/elasticsearch/issues/17991#issuecomment-214843650","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17991","id":214843650,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNDg0MzY1MA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-04-26T18:38:39Z","updated_at":"2016-04-26T18:38:39Z","author_association":"CONTRIBUTOR","body":"@ywelsch any ideas?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215023935","html_url":"https://github.com/elastic/elasticsearch/issues/17991#issuecomment-215023935","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17991","id":215023935,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTAyMzkzNQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2016-04-27T09:20:22Z","updated_at":"2016-04-27T09:20:22Z","author_association":"CONTRIBUTOR","body":"@dforste Are there any warnings in the logs? Can you provide thread dumps of the nodes that are stuck? What happens if you delete the snapshot that is stuck? Does that unblock the nodes?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215125711","html_url":"https://github.com/elastic/elasticsearch/issues/17991#issuecomment-215125711","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17991","id":215125711,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTEyNTcxMQ==","user":{"login":"dforste","id":5168898,"node_id":"MDQ6VXNlcjUxNjg4OTg=","avatar_url":"https://avatars2.githubusercontent.com/u/5168898?v=4","gravatar_id":"","url":"https://api.github.com/users/dforste","html_url":"https://github.com/dforste","followers_url":"https://api.github.com/users/dforste/followers","following_url":"https://api.github.com/users/dforste/following{/other_user}","gists_url":"https://api.github.com/users/dforste/gists{/gist_id}","starred_url":"https://api.github.com/users/dforste/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dforste/subscriptions","organizations_url":"https://api.github.com/users/dforste/orgs","repos_url":"https://api.github.com/users/dforste/repos","events_url":"https://api.github.com/users/dforste/events{/privacy}","received_events_url":"https://api.github.com/users/dforste/received_events","type":"User","site_admin":false},"created_at":"2016-04-27T15:44:06Z","updated_at":"2016-04-27T15:44:06Z","author_association":"NONE","body":"@ywelsch I have tried deleting it before but that doesn't work either. Only rebooting/restarting the nodes tells me which one is stuck via the defunct java process. I cant find my thread dumps from before so I will have to wait a bit and I will try to get you some. \n\nElasticsearch continues doing everything else while this is happening. Only seems like snapshot and restore are affected. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215135121","html_url":"https://github.com/elastic/elasticsearch/issues/17991#issuecomment-215135121","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17991","id":215135121,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTEzNTEyMQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2016-04-27T16:14:37Z","updated_at":"2016-04-27T16:14:37Z","author_association":"CONTRIBUTOR","body":"How is the nfs volume mounted? It could be that the mount options are at fault: See e.g. `soft` vs. `hard` mount options here:\nhttp://unix.stackexchange.com/questions/31979/stop-broken-nfs-mounts-from-locking-a-directory\n\n> hard or soft â€” Specifies whether the program using a file via an NFS connection should stop and wait (hard) for the server to come back online, if the host serving the exported file system is unavailable, or if it should report an error (soft).\n> \n> If hard is specified, the user cannot terminate the process waiting for the NFS communication to resume unless the intr option is also specified.\n> \n> If soft is specified, the user can set an additional timeo=<value> option, where <value> specifies the number of seconds to pass before the error is reported.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/221231006","html_url":"https://github.com/elastic/elasticsearch/issues/17991#issuecomment-221231006","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17991","id":221231006,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMTIzMTAwNg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-05-24T10:37:06Z","updated_at":"2016-05-24T10:37:06Z","author_association":"CONTRIBUTOR","body":"No further feedback.  Closing\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223665247","html_url":"https://github.com/elastic/elasticsearch/issues/17991#issuecomment-223665247","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17991","id":223665247,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzY2NTI0Nw==","user":{"login":"dforste","id":5168898,"node_id":"MDQ6VXNlcjUxNjg4OTg=","avatar_url":"https://avatars2.githubusercontent.com/u/5168898?v=4","gravatar_id":"","url":"https://api.github.com/users/dforste","html_url":"https://github.com/dforste","followers_url":"https://api.github.com/users/dforste/followers","following_url":"https://api.github.com/users/dforste/following{/other_user}","gists_url":"https://api.github.com/users/dforste/gists{/gist_id}","starred_url":"https://api.github.com/users/dforste/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dforste/subscriptions","organizations_url":"https://api.github.com/users/dforste/orgs","repos_url":"https://api.github.com/users/dforste/repos","events_url":"https://api.github.com/users/dforste/events{/privacy}","received_events_url":"https://api.github.com/users/dforste/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T19:02:09Z","updated_at":"2016-06-03T20:22:42Z","author_association":"NONE","body":"Sorry for not responding earlier. I had an issue where stdout was going to dev/null. Also adjusting snapshots to only snapshot the last week helped tremendously. I am attaching threadumps for the data nodes involved with the snapshot and the current master. \n\n[threadump-6-3-2016.tar.gz](https://github.com/elastic/elasticsearch/files/298217/threadump-6-3-2016.tar.gz)\n\nHere are all the nfs mount options set in fstab: \n`auto,rw,bg,vers=3,intr,soft,noatime,actimeo=300,nosuid,bg,rsize=32768,wsize=32768`\n\nNode 1 was the one that was left in a defunct state and needed to reboot. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261789707","html_url":"https://github.com/elastic/elasticsearch/issues/17991#issuecomment-261789707","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17991","id":261789707,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTc4OTcwNw==","user":{"login":"schonfeld","id":130491,"node_id":"MDQ6VXNlcjEzMDQ5MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/130491?v=4","gravatar_id":"","url":"https://api.github.com/users/schonfeld","html_url":"https://github.com/schonfeld","followers_url":"https://api.github.com/users/schonfeld/followers","following_url":"https://api.github.com/users/schonfeld/following{/other_user}","gists_url":"https://api.github.com/users/schonfeld/gists{/gist_id}","starred_url":"https://api.github.com/users/schonfeld/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schonfeld/subscriptions","organizations_url":"https://api.github.com/users/schonfeld/orgs","repos_url":"https://api.github.com/users/schonfeld/repos","events_url":"https://api.github.com/users/schonfeld/events{/privacy}","received_events_url":"https://api.github.com/users/schonfeld/received_events","type":"User","site_admin":false},"created_at":"2016-11-20T16:53:43Z","updated_at":"2016-11-20T16:53:43Z","author_association":"CONTRIBUTOR","body":"@dforste did you ever resolve this? I believe we're seeing something similar in v2.4.1... Any insight would be great!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261816136","html_url":"https://github.com/elastic/elasticsearch/issues/17991#issuecomment-261816136","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17991","id":261816136,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTgxNjEzNg==","user":{"login":"dforste","id":5168898,"node_id":"MDQ6VXNlcjUxNjg4OTg=","avatar_url":"https://avatars2.githubusercontent.com/u/5168898?v=4","gravatar_id":"","url":"https://api.github.com/users/dforste","html_url":"https://github.com/dforste","followers_url":"https://api.github.com/users/dforste/followers","following_url":"https://api.github.com/users/dforste/following{/other_user}","gists_url":"https://api.github.com/users/dforste/gists{/gist_id}","starred_url":"https://api.github.com/users/dforste/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dforste/subscriptions","organizations_url":"https://api.github.com/users/dforste/orgs","repos_url":"https://api.github.com/users/dforste/repos","events_url":"https://api.github.com/users/dforste/events{/privacy}","received_events_url":"https://api.github.com/users/dforste/received_events","type":"User","site_admin":false},"created_at":"2016-11-20T23:52:28Z","updated_at":"2016-11-20T23:52:28Z","author_association":"NONE","body":"@schonfeld I did not ever get it fully resolved. I did however minimize how often it happened by minimizing the amount we snapshot to just the previous week. I was doing all the indexes in one job but that is a bit too much. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261946153","html_url":"https://github.com/elastic/elasticsearch/issues/17991#issuecomment-261946153","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17991","id":261946153,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTk0NjE1Mw==","user":{"login":"schonfeld","id":130491,"node_id":"MDQ6VXNlcjEzMDQ5MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/130491?v=4","gravatar_id":"","url":"https://api.github.com/users/schonfeld","html_url":"https://github.com/schonfeld","followers_url":"https://api.github.com/users/schonfeld/followers","following_url":"https://api.github.com/users/schonfeld/following{/other_user}","gists_url":"https://api.github.com/users/schonfeld/gists{/gist_id}","starred_url":"https://api.github.com/users/schonfeld/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schonfeld/subscriptions","organizations_url":"https://api.github.com/users/schonfeld/orgs","repos_url":"https://api.github.com/users/schonfeld/repos","events_url":"https://api.github.com/users/schonfeld/events{/privacy}","received_events_url":"https://api.github.com/users/schonfeld/received_events","type":"User","site_admin":false},"created_at":"2016-11-21T14:03:00Z","updated_at":"2016-11-21T14:03:00Z","author_association":"CONTRIBUTOR","body":"@dforste got it, thanks! fwiw, we just setup a [minio](https://www.minio.io/) instance, and are using Elasticsearch's standard S3 snapshot plugin. Seems to be working very well!","performed_via_github_app":null}]
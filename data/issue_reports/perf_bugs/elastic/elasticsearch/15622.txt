{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15622","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15622/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15622/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15622/events","html_url":"https://github.com/elastic/elasticsearch/issues/15622","id":123606895,"node_id":"MDU6SXNzdWUxMjM2MDY4OTU=","number":15622,"title":"Primary shard stuck initialising","user":{"login":"robertsmarty","id":4920375,"node_id":"MDQ6VXNlcjQ5MjAzNzU=","avatar_url":"https://avatars0.githubusercontent.com/u/4920375?v=4","gravatar_id":"","url":"https://api.github.com/users/robertsmarty","html_url":"https://github.com/robertsmarty","followers_url":"https://api.github.com/users/robertsmarty/followers","following_url":"https://api.github.com/users/robertsmarty/following{/other_user}","gists_url":"https://api.github.com/users/robertsmarty/gists{/gist_id}","starred_url":"https://api.github.com/users/robertsmarty/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robertsmarty/subscriptions","organizations_url":"https://api.github.com/users/robertsmarty/orgs","repos_url":"https://api.github.com/users/robertsmarty/repos","events_url":"https://api.github.com/users/robertsmarty/events{/privacy}","received_events_url":"https://api.github.com/users/robertsmarty/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":17,"created_at":"2015-12-23T06:01:55Z","updated_at":"2016-01-07T16:45:57Z","closed_at":"2016-01-06T04:07:22Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\n\nThis is related to https://github.com/elastic/elasticsearch/issues/15431 however now I have some more info. I am processing over 200GB of PA firewall logs per day. The cluster is working really well until I make any changes. I just started rolling in 2.1.1 into the 2.1.0 cluster and when the shards started relocating one of the primary shards got stuck initialising. I couldn't get it working so I wound up trashing the whole cluster and deploying the whole thing again with just 2.1.1. Not a massive task as we have automated deployment so no problem there. The logs started streaming in again and then I started restoring my data which was working well until again, one of the primary shards got stuck initialising again. It's also an active shard, lots of data trying to go in there. I then tried deleting the index and have it dynamically create again however the primary shard is stuck again and I have this error in the logs...\n\n[2015-12-23 15:47:18,442][DEBUG][action.admin.indices.recovery] [elkrp14] [indices:monitor/recovery] failed to execute operation for shard [[pa_traffic-2015.12.23][4], node[ijdqvmZHTi66urgpuvCyUQ], [P], v[1], s[INITIALIZING], a[id=3A8c4qmfSU6cggJqOAu9bA], unassigned_info[[reason=INDEX_CREATED], at[2015-12-23T05:38:42.740Z]]]\n[pa_traffic-2015.12.23][[pa_traffic-2015.12.23][4]] BroadcastShardOperationFailedException[operation indices:monitor/recovery failed]; nested: IndexNotFoundException[no such index];\n    at org.elasticsearch.action.support.broadcast.node.TransportBroadcastByNodeAction$BroadcastByNodeTransportRequestHandler.onShardOperation(TransportBroadcastByNodeAction.java:405)\n    at org.elasticsearch.action.support.broadcast.node.TransportBroadcastByNodeAction$BroadcastByNodeTransportRequestHandler.messageReceived(TransportBroadcastByNodeAction.java:382)\n    at org.elasticsearch.action.support.broadcast.node.TransportBroadcastByNodeAction$BroadcastByNodeTransportRequestHandler.messageReceived(TransportBroadcastByNodeAction.java:371)\n    at org.elasticsearch.shield.transport.ShieldServerTransportService$ProfileSecuredRequestHandler.messageReceived(ShieldServerTransportService.java:165)\n    at org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.doRun(MessageChannelHandler.java:299)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: [pa_traffic-2015.12.23] IndexNotFoundException[no such index]\n    at org.elasticsearch.indices.IndicesService.indexServiceSafe(IndicesService.java:310)\n    at org.elasticsearch.action.admin.indices.recovery.TransportRecoveryAction.shardOperation(TransportRecoveryAction.java:102)\n    at org.elasticsearch.action.admin.indices.recovery.TransportRecoveryAction.shardOperation(TransportRecoveryAction.java:52)\n    at org.elasticsearch.action.support.broadcast.node.TransportBroadcastByNodeAction$BroadcastByNodeTransportRequestHandler.onShardOperation(TransportBroadcastByNodeAction.java:401)\n    ... 8 more\n\nAny ideas?\n\nCheers,\n\nMarty\n","closed_by":{"login":"robertsmarty","id":4920375,"node_id":"MDQ6VXNlcjQ5MjAzNzU=","avatar_url":"https://avatars0.githubusercontent.com/u/4920375?v=4","gravatar_id":"","url":"https://api.github.com/users/robertsmarty","html_url":"https://github.com/robertsmarty","followers_url":"https://api.github.com/users/robertsmarty/followers","following_url":"https://api.github.com/users/robertsmarty/following{/other_user}","gists_url":"https://api.github.com/users/robertsmarty/gists{/gist_id}","starred_url":"https://api.github.com/users/robertsmarty/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robertsmarty/subscriptions","organizations_url":"https://api.github.com/users/robertsmarty/orgs","repos_url":"https://api.github.com/users/robertsmarty/repos","events_url":"https://api.github.com/users/robertsmarty/events{/privacy}","received_events_url":"https://api.github.com/users/robertsmarty/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/21602","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21602/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21602/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21602/events","html_url":"https://github.com/elastic/elasticsearch/issues/21602","id":189819670,"node_id":"MDU6SXNzdWUxODk4MTk2NzA=","number":21602,"title":"Slowlog cannot handle very long queries and truncates the log entry","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2016-11-16T19:38:06Z","updated_at":"2016-11-17T02:45:15Z","closed_at":"2016-11-17T02:45:15Z","author_association":"MEMBER","active_lock_reason":null,"body":"5.0.\r\n\r\nCan't share the actual query here, but feel free to reach out to me directly.\r\n\r\nSingle query is sent via curl @test.json (which is a 956Kb file, with 32K+ lines, with a very large terms filter).  The resulting log entry in the slowlog shows the following, with none of the usual took time, shard hit information, but an entry that starts with just the bottom part of the query where the large terms filter is.\r\n\r\n```\r\n[2016-11-16T11:32:46,279][DEBUG][index.search.slowlog.query] [H9GIwD1]                   42324,\r\n                      61981,\r\n                      395144,\r\n                      420125,\r\n                      376625,\r\n                      27874,\r\n                      102929,\r\n```\r\n\r\nActual query has:\r\n\r\n```\r\n                {\r\n                  \"terms\": {\r\n                    \"some_field\": [\r\n                      <a large number of longs here>\r\n                   ]\r\n```\r\n\r\nJust to clarify this ticket is more about slowlog handling of large queries (we are already aware that having that many terms in a terms filter is not the ideal approach here).","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
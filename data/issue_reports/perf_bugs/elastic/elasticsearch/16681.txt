{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16681","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16681/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16681/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16681/events","html_url":"https://github.com/elastic/elasticsearch/issues/16681","id":133786000,"node_id":"MDU6SXNzdWUxMzM3ODYwMDA=","number":16681,"title":"Observing 6x slowdown while indexing documents on upgrading from 1.7 to 2.2","user":{"login":"sacheendra","id":5353969,"node_id":"MDQ6VXNlcjUzNTM5Njk=","avatar_url":"https://avatars1.githubusercontent.com/u/5353969?v=4","gravatar_id":"","url":"https://api.github.com/users/sacheendra","html_url":"https://github.com/sacheendra","followers_url":"https://api.github.com/users/sacheendra/followers","following_url":"https://api.github.com/users/sacheendra/following{/other_user}","gists_url":"https://api.github.com/users/sacheendra/gists{/gist_id}","starred_url":"https://api.github.com/users/sacheendra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sacheendra/subscriptions","organizations_url":"https://api.github.com/users/sacheendra/orgs","repos_url":"https://api.github.com/users/sacheendra/repos","events_url":"https://api.github.com/users/sacheendra/events{/privacy}","received_events_url":"https://api.github.com/users/sacheendra/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-02-15T18:27:36Z","updated_at":"2016-02-16T08:41:02Z","closed_at":"2016-02-16T08:41:02Z","author_association":"NONE","active_lock_reason":null,"body":"The slowdown occurred while doing a benchmark of index rate of documents with a single string field. \n\nexample doc: '{ \"message\": \"this is a random sentence\" }'\n\nThe benchmark is for a single node(AWS EC2 c4.2xlarge). The index has 1 shard and no replicas. The mapping is generated automatically. A 250GB general purpose SSD EBS volume was used for data. \n\nOn 1.7, I observed an index rate of 2.2k/sec, but on 2.2 I just see a rate of around 360/sec. \n\nThe code used for the benchmark is here: [https://github.com/sacheendra/es_benchmark](https://github.com/sacheendra/es_benchmark)\nThe master branch is for 2.2 and the 1.7 branch is for 1.7. The benchmark script was run on a separate machine. (EC2 c3.8xlarge)\n\nElasticsearch was deployed using docker with data volume mapped to disk. \n\nThe CPU usage is around 10%. About 5GB/250GB is used after an 8hr run. The RAM usage is as seen in the chart below. \n\n<img width=\"857\" alt=\"screen shot 2016-02-15 at 11 51 47 pm\" src=\"https://cloud.githubusercontent.com/assets/5353969/13057037/7b7689b6-d43f-11e5-9ad2-e872ac936cb7.png\">\n\nWhat could be the reason for this slowdown? \n\nAlso any idea on why the memory usage id increasing so fast?\n","closed_by":{"login":"sacheendra","id":5353969,"node_id":"MDQ6VXNlcjUzNTM5Njk=","avatar_url":"https://avatars1.githubusercontent.com/u/5353969?v=4","gravatar_id":"","url":"https://api.github.com/users/sacheendra","html_url":"https://github.com/sacheendra","followers_url":"https://api.github.com/users/sacheendra/followers","following_url":"https://api.github.com/users/sacheendra/following{/other_user}","gists_url":"https://api.github.com/users/sacheendra/gists{/gist_id}","starred_url":"https://api.github.com/users/sacheendra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sacheendra/subscriptions","organizations_url":"https://api.github.com/users/sacheendra/orgs","repos_url":"https://api.github.com/users/sacheendra/repos","events_url":"https://api.github.com/users/sacheendra/events{/privacy}","received_events_url":"https://api.github.com/users/sacheendra/received_events","type":"User","site_admin":false},"performed_via_github_app":null}